import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as x}from"./index.Z3BHPS3u.js";import{u as h}from"./use-outside-click.DYGsxgbd.js";import{u as b}from"./use-keydown.r409VyJJ.js";import{u as j}from"./use-toast.BdCcSTJE.js";import{u as v}from"./useMutation.BxVH4XRI.js";import{q as f}from"./query-client.zrB8z_yM.js";import{b as y}from"./query-http.BQfMbvYq.js";import{E as w}from"./ellipsis-vertical.Di0fjBX0.js";import{P as N}from"./play.-yCdF7S0.js";import{T as C}from"./trash-2.CIQaIo_h.js";import{g as k}from"./date.2wIYh-wy.js";import{c as p}from"./classname.y9b8gBZq.js";import{B as g}from"./book-open.Dsgc4gH7.js";function A(c){const{courseSlug:s,onDeleted:d}=c,i=j(),r=x.useRef(null),[n,a]=x.useState(!1),[t,l]=x.useState(!1),{mutate:m,isPending:u}=v({mutationFn:async()=>y(`/v1-delete-ai-course/${s}`),onSuccess:()=>{i.success("Course deleted"),f.invalidateQueries({predicate:o=>o.queryKey?.[0]==="user-ai-courses"}),d?.()},onError:o=>{i.error(o?.message||"Failed to delete course")}},f);return h(r,()=>{a(!1)}),b("Escape",()=>{a(!1)}),e.jsxs("div",{className:"relative h-full",ref:r,children:[e.jsx("button",{className:"h-full text-gray-400 hover:text-gray-700",onClick:o=>{o.stopPropagation(),a(!n)},children:e.jsx(w,{size:16})}),n&&e.jsxs("div",{className:"absolute right-0 top-8 z-10 w-48 overflow-hidden rounded-md border border-gray-200 bg-white shadow-lg",children:[e.jsxs("a",{href:`/ai/${s}`,className:"flex w-full items-center gap-1.5 p-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-black disabled:cursor-not-allowed disabled:opacity-70",children:[e.jsx(N,{className:"h-3.5 w-3.5"}),"Start Course"]}),!t&&e.jsx("button",{className:"flex w-full items-center gap-1.5 p-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-black disabled:cursor-not-allowed disabled:opacity-70",onClick:()=>l(!0),disabled:u,children:u?"Deleting...":e.jsxs(e.Fragment,{children:[e.jsx(C,{className:"h-3.5 w-3.5"}),"Delete Course"]})}),t&&e.jsxs("span",{className:"flex w-full items-center justify-between gap-1.5 p-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-black disabled:cursor-not-allowed disabled:opacity-70",children:["Are you sure?",e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{l(!1),m()},disabled:u,className:"text-red-500 underline hover:text-red-800",children:"Yes"}),e.jsx("button",{onClick:()=>l(!1),className:"text-red-500 underline hover:text-red-800",children:"No"})]})]})]})]})}function K(c){const{course:s,showActions:d=!0,showProgress:i=!0,variant:r="row"}=c,n={beginner:"text-green-700",intermediate:"text-blue-700",advanced:"text-purple-700"}[s.difficulty]||"text-gray-700",a=s.modules?.length||0,t=s.lessonCount||0,l=s.done?.length||0,m=t>0?Math.round(l/t*100):0;return k(s?.updatedAt),e.jsxs("div",{className:"relative flex flex-grow",children:[e.jsxs("a",{href:`/ai/${s.slug}`,className:p("group relative flex h-full w-full gap-3 overflow-hidden rounded-lg border border-gray-200 bg-white p-4 text-left transition-all hover:border-gray-300 hover:bg-gray-50 sm:gap-4",r==="column"&&"flex-col",r==="row"&&"flex-row sm:flex-row sm:items-center"),children:[e.jsxs("div",{className:"min-w-0 flex-1",children:[s.difficulty&&e.jsx("div",{className:"mb-1 flex items-center gap-2",children:e.jsx("span",{className:`rounded-full text-xs font-medium capitalize opacity-80 ${n}`,children:s.difficulty})}),e.jsx("h3",{className:p("line-clamp-2 text-base font-semibold text-balance text-gray-900",{"max-w-[95%]":r==="column"}),children:s.title?.replace(": A Beginner's Guide","")?.replace(" for beginners","")?.replace(": A Comprehensive Guide","")})]}),e.jsxs("div",{className:"mt-7 flex items-center gap-4 sm:gap-4",children:[e.jsxs("div",{className:"hidden items-center text-xs text-gray-600 sm:flex",children:[e.jsx(g,{className:"mr-1 h-3.5 w-3.5"}),e.jsxs("span",{children:[a," modules"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-600",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(g,{className:"mr-1 h-3.5 w-3.5"}),e.jsxs("span",{children:[t," lessons"]})]}),i&&t>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"hidden text-gray-400 sm:inline",children:"â€¢"}),e.jsx("div",{className:"flex items-center",children:e.jsxs("span",{className:"flex items-center text-xs font-medium text-gray-700",children:[m,"% complete"]})})]})]})]})]}),d&&s.slug&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(A,{courseSlug:s.slug})})]})}export{K as A};
