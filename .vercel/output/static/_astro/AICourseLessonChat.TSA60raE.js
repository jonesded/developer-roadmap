import{j as g}from"./jsx-runtime.D_zvdyIk.js";/* empty css                        */import{u as Ve,q as Ae}from"./query-client.zrB8z_yM.js";import{r as u,R as Rt}from"./index.Z3BHPS3u.js";import{r as Se}from"./index.BlPpvBlM.js";import{i as Nt}from"./react-textarea-autosize.browser.esm.CREEQHIU.js";import{u as Lt}from"./use-toast.BdCcSTJE.js";import{r as At}from"./ai.DmXEK0i3.js";import{c as xe}from"./classname.y9b8gBZq.js";import{i as je,r as jt}from"./jwt.1xGNZsvU.js";import{m as Mt,a as Ht}from"./markdown.CL3gtrVM.js";import{a as qe}from"./ai-course.m2sFB2uK.js";import{b as Dt}from"./billing.Dog7Gwv_.js";import{c as $t}from"./createLucideIcon.BSLrQS80.js";import{S as _t}from"./Spinner.CPY-6wbR.js";import{s as Tt}from"./popup.CdCAhVM2.js";import{U as Gt}from"./user-round.D2mOPNuO.js";import{B as st}from"./bot.CQ2bIWO6.js";import{X as Xe}from"./x.BOdyWiWF.js";import{L as Je}from"./lock.C0C-BW9S.js";import{S as Bt}from"./send.BVE6djDn.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ut=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Wt=$t("grip-vertical",Ut),Ee=u.createContext(null);Ee.displayName="PanelGroupContext";const $={group:"data-panel-group",groupDirection:"data-panel-group-direction",groupId:"data-panel-group-id",panel:"data-panel",panelCollapsible:"data-panel-collapsible",panelId:"data-panel-id",panelSize:"data-panel-size",resizeHandle:"data-resize-handle",resizeHandleActive:"data-resize-handle-active",resizeHandleEnabled:"data-panel-resize-handle-enabled",resizeHandleId:"data-panel-resize-handle-id",resizeHandleState:"data-resize-handle-state"},Be=10,se=u.useLayoutEffect,Qe=Rt.useId,Ft=typeof Qe=="function"?Qe:()=>null;let Ot=0;function Ue(e=null){const t=Ft(),n=u.useRef(e||t||null);return n.current===null&&(n.current=""+Ot++),e??n.current}function it({children:e,className:t="",collapsedSize:n,collapsible:r,defaultSize:s,forwardedRef:o,id:i,maxSize:l,minSize:a,onCollapse:h,onExpand:C,onResize:p,order:c,style:b,tagName:m="div",...I}){const k=u.useContext(Ee);if(k===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:z,expandPanel:N,getPanelSize:A,getPanelStyle:H,groupId:O,isPanelCollapsed:R,reevaluatePanelConstraints:P,registerPanel:K,resizePanel:Q,unregisterPanel:B}=k,T=Ue(i),j=u.useRef({callbacks:{onCollapse:h,onExpand:C,onResize:p},constraints:{collapsedSize:n,collapsible:r,defaultSize:s,maxSize:l,minSize:a},id:T,idIsFromProps:i!==void 0,order:c});u.useRef({didLogMissingDefaultSizeWarning:!1}),se(()=>{const{callbacks:G,constraints:E}=j.current,M={...E};j.current.id=T,j.current.idIsFromProps=i!==void 0,j.current.order=c,G.onCollapse=h,G.onExpand=C,G.onResize=p,E.collapsedSize=n,E.collapsible=r,E.defaultSize=s,E.maxSize=l,E.minSize=a,(M.collapsedSize!==E.collapsedSize||M.collapsible!==E.collapsible||M.maxSize!==E.maxSize||M.minSize!==E.minSize)&&P(j.current,M)}),se(()=>{const G=j.current;return K(G),()=>{B(G)}},[c,T,K,B]),u.useImperativeHandle(o,()=>({collapse:()=>{z(j.current)},expand:G=>{N(j.current,G)},getId(){return T},getSize(){return A(j.current)},isCollapsed(){return R(j.current)},isExpanded(){return!R(j.current)},resize:G=>{Q(j.current,G)}}),[z,N,A,R,T,Q]);const q=H(j.current,s);return u.createElement(m,{...I,children:e,className:t,id:T,style:{...q,...b},[$.groupId]:O,[$.panel]:"",[$.panelCollapsible]:r||void 0,[$.panelId]:T,[$.panelSize]:parseFloat(""+q.flexGrow).toFixed(1)})}const lt=u.forwardRef((e,t)=>u.createElement(it,{...e,forwardedRef:t}));it.displayName="Panel";lt.displayName="forwardRef(Panel)";let Ge=null,Pe=-1,te=null;function Kt(e,t){if(t){const n=(t&ft)!==0,r=(t&pt)!==0,s=(t&mt)!==0,o=(t&gt)!==0;if(n)return s?"se-resize":o?"ne-resize":"e-resize";if(r)return s?"sw-resize":o?"nw-resize":"w-resize";if(s)return"s-resize";if(o)return"n-resize"}switch(e){case"horizontal":return"ew-resize";case"intersection":return"move";case"vertical":return"ns-resize"}}function Vt(){te!==null&&(document.head.removeChild(te),Ge=null,te=null,Pe=-1)}function Me(e,t){var n,r;const s=Kt(e,t);if(Ge!==s){if(Ge=s,te===null&&(te=document.createElement("style"),document.head.appendChild(te)),Pe>=0){var o;(o=te.sheet)===null||o===void 0||o.removeRule(Pe)}Pe=(n=(r=te.sheet)===null||r===void 0?void 0:r.insertRule(`*{cursor: ${s} !important;}`))!==null&&n!==void 0?n:-1}}function at(e){return e.type==="keydown"}function ct(e){return e.type.startsWith("pointer")}function ut(e){return e.type.startsWith("mouse")}function Ie(e){if(ct(e)){if(e.isPrimary)return{x:e.clientX,y:e.clientY}}else if(ut(e))return{x:e.clientX,y:e.clientY};return{x:1/0,y:1/0}}function qt(){if(typeof matchMedia=="function")return matchMedia("(pointer:coarse)").matches?"coarse":"fine"}function Xt(e,t,n){return e.x<t.x+t.width&&e.x+e.width>t.x&&e.y<t.y+t.height&&e.y+e.height>t.y}function Jt(e,t){if(e===t)throw new Error("Cannot compare node with itself");const n={a:et(e),b:et(t)};let r;for(;n.a.at(-1)===n.b.at(-1);)e=n.a.pop(),t=n.b.pop(),r=e;S(r,"Stacking order can only be calculated for elements with a common ancestor");const s={a:Ze(Ye(n.a)),b:Ze(Ye(n.b))};if(s.a===s.b){const o=r.childNodes,i={a:n.a.at(-1),b:n.b.at(-1)};let l=o.length;for(;l--;){const a=o[l];if(a===i.a)return 1;if(a===i.b)return-1}}return Math.sign(s.a-s.b)}const Qt=/\b(?:position|zIndex|opacity|transform|webkitTransform|mixBlendMode|filter|webkitFilter|isolation)\b/;function Yt(e){var t;const n=getComputedStyle((t=dt(e))!==null&&t!==void 0?t:e).display;return n==="flex"||n==="inline-flex"}function Zt(e){const t=getComputedStyle(e);return!!(t.position==="fixed"||t.zIndex!=="auto"&&(t.position!=="static"||Yt(e))||+t.opacity<1||"transform"in t&&t.transform!=="none"||"webkitTransform"in t&&t.webkitTransform!=="none"||"mixBlendMode"in t&&t.mixBlendMode!=="normal"||"filter"in t&&t.filter!=="none"||"webkitFilter"in t&&t.webkitFilter!=="none"||"isolation"in t&&t.isolation==="isolate"||Qt.test(t.willChange)||t.webkitOverflowScrolling==="touch")}function Ye(e){let t=e.length;for(;t--;){const n=e[t];if(S(n,"Missing node"),Zt(n))return n}return null}function Ze(e){return e&&Number(getComputedStyle(e).zIndex)||0}function et(e){const t=[];for(;e;)t.push(e),e=dt(e);return t}function dt(e){const{parentNode:t}=e;return t&&t instanceof ShadowRoot?t.host:t}const ft=1,pt=2,mt=4,gt=8,en=qt()==="coarse";let J=[],de=!1,ne=new Map,Re=new Map;const ye=new Set;function tn(e,t,n,r,s){var o;const{ownerDocument:i}=t,l={direction:n,element:t,hitAreaMargins:r,setResizeHandlerState:s},a=(o=ne.get(i))!==null&&o!==void 0?o:0;return ne.set(i,a+1),ye.add(l),Ce(),function(){var C;Re.delete(e),ye.delete(l);const p=(C=ne.get(i))!==null&&C!==void 0?C:1;if(ne.set(i,p-1),Ce(),p===1&&ne.delete(i),J.includes(l)){const c=J.indexOf(l);c>=0&&J.splice(c,1),Fe(),s("up",!0,null)}}}function nn(e){const{target:t}=e,{x:n,y:r}=Ie(e);de=!0,We({target:t,x:n,y:r}),Ce(),J.length>0&&(ke("down",e),e.preventDefault(),ht(t)||e.stopImmediatePropagation())}function He(e){const{x:t,y:n}=Ie(e);if(de&&e.buttons===0&&(de=!1,ke("up",e)),!de){const{target:r}=e;We({target:r,x:t,y:n})}ke("move",e),Fe(),J.length>0&&e.preventDefault()}function De(e){const{target:t}=e,{x:n,y:r}=Ie(e);Re.clear(),de=!1,J.length>0&&(e.preventDefault(),ht(t)||e.stopImmediatePropagation()),ke("up",e),We({target:t,x:n,y:r}),Fe(),Ce()}function ht(e){let t=e;for(;t;){if(t.hasAttribute($.resizeHandle))return!0;t=t.parentElement}return!1}function We({target:e,x:t,y:n}){J.splice(0);let r=null;(e instanceof HTMLElement||e instanceof SVGElement)&&(r=e),ye.forEach(s=>{const{element:o,hitAreaMargins:i}=s,l=o.getBoundingClientRect(),{bottom:a,left:h,right:C,top:p}=l,c=en?i.coarse:i.fine;if(t>=h-c&&t<=C+c&&n>=p-c&&n<=a+c){if(r!==null&&document.contains(r)&&o!==r&&!o.contains(r)&&!r.contains(o)&&Jt(r,o)>0){let m=r,I=!1;for(;m&&!m.contains(o);){if(Xt(m.getBoundingClientRect(),l)){I=!0;break}m=m.parentElement}if(I)return}J.push(s)}})}function $e(e,t){Re.set(e,t)}function Fe(){let e=!1,t=!1;J.forEach(r=>{const{direction:s}=r;s==="horizontal"?e=!0:t=!0});let n=0;Re.forEach(r=>{n|=r}),e&&t?Me("intersection",n):e?Me("horizontal",n):t?Me("vertical",n):Vt()}let _e=new AbortController;function Ce(){_e.abort(),_e=new AbortController;const e={capture:!0,signal:_e.signal};ye.size&&(de?(J.length>0&&ne.forEach((t,n)=>{const{body:r}=n;t>0&&(r.addEventListener("contextmenu",De,e),r.addEventListener("pointerleave",He,e),r.addEventListener("pointermove",He,e))}),ne.forEach((t,n)=>{const{body:r}=n;r.addEventListener("pointerup",De,e),r.addEventListener("pointercancel",De,e)})):ne.forEach((t,n)=>{const{body:r}=n;t>0&&(r.addEventListener("pointerdown",nn,e),r.addEventListener("pointermove",He,e))}))}function ke(e,t){ye.forEach(n=>{const{setResizeHandlerState:r}=n,s=J.includes(n);r(e,s,t)})}function rn(){const[e,t]=u.useState(0);return u.useCallback(()=>t(n=>n+1),[])}function S(e,t){if(!e)throw console.error(t),Error(t)}function ie(e,t,n=Be){return e.toFixed(n)===t.toFixed(n)?0:e>t?1:-1}function ee(e,t,n=Be){return ie(e,t,n)===0}function V(e,t,n){return ie(e,t,n)===0}function on(e,t,n){if(e.length!==t.length)return!1;for(let r=0;r<e.length;r++){const s=e[r],o=t[r];if(!V(s,o,n))return!1}return!0}function ue({panelConstraints:e,panelIndex:t,size:n}){const r=e[t];S(r!=null,`Panel constraints not found for index ${t}`);let{collapsedSize:s=0,collapsible:o,maxSize:i=100,minSize:l=0}=r;if(ie(n,l)<0)if(o){const a=(s+l)/2;ie(n,a)<0?n=s:n=l}else n=l;return n=Math.min(i,n),n=parseFloat(n.toFixed(Be)),n}function ge({delta:e,initialLayout:t,panelConstraints:n,pivotIndices:r,prevLayout:s,trigger:o}){if(V(e,0))return t;const i=[...t],[l,a]=r;S(l!=null,"Invalid first pivot index"),S(a!=null,"Invalid second pivot index");let h=0;if(o==="keyboard"){{const p=e<0?a:l,c=n[p];S(c,`Panel constraints not found for index ${p}`);const{collapsedSize:b=0,collapsible:m,minSize:I=0}=c;if(m){const k=t[p];if(S(k!=null,`Previous layout not found for panel index ${p}`),V(k,b)){const z=I-k;ie(z,Math.abs(e))>0&&(e=e<0?0-z:z)}}}{const p=e<0?l:a,c=n[p];S(c,`No panel constraints found for index ${p}`);const{collapsedSize:b=0,collapsible:m,minSize:I=0}=c;if(m){const k=t[p];if(S(k!=null,`Previous layout not found for panel index ${p}`),V(k,I)){const z=k-b;ie(z,Math.abs(e))>0&&(e=e<0?0-z:z)}}}}{const p=e<0?1:-1;let c=e<0?a:l,b=0;for(;;){const I=t[c];S(I!=null,`Previous layout not found for panel index ${c}`);const z=ue({panelConstraints:n,panelIndex:c,size:100})-I;if(b+=z,c+=p,c<0||c>=n.length)break}const m=Math.min(Math.abs(e),Math.abs(b));e=e<0?0-m:m}{let c=e<0?l:a;for(;c>=0&&c<n.length;){const b=Math.abs(e)-Math.abs(h),m=t[c];S(m!=null,`Previous layout not found for panel index ${c}`);const I=m-b,k=ue({panelConstraints:n,panelIndex:c,size:I});if(!V(m,k)&&(h+=m-k,i[c]=k,h.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?c--:c++}}if(on(s,i))return s;{const p=e<0?a:l,c=t[p];S(c!=null,`Previous layout not found for panel index ${p}`);const b=c+h,m=ue({panelConstraints:n,panelIndex:p,size:b});if(i[p]=m,!V(m,b)){let I=b-m,z=e<0?a:l;for(;z>=0&&z<n.length;){const N=i[z];S(N!=null,`Previous layout not found for panel index ${z}`);const A=N+I,H=ue({panelConstraints:n,panelIndex:z,size:A});if(V(N,H)||(I-=H-N,i[z]=H),V(I,0))break;e>0?z--:z++}}}const C=i.reduce((p,c)=>c+p,0);return V(C,100)?i:s}function sn({layout:e,panelsArray:t,pivotIndices:n}){let r=0,s=100,o=0,i=0;const l=n[0];S(l!=null,"No pivot index found"),t.forEach((p,c)=>{const{constraints:b}=p,{maxSize:m=100,minSize:I=0}=b;c===l?(r=I,s=m):(o+=I,i+=m)});const a=Math.min(s,100-o),h=Math.max(r,100-i),C=e[l];return{valueMax:a,valueMin:h,valueNow:C}}function be(e,t=document){return Array.from(t.querySelectorAll(`[${$.resizeHandleId}][data-panel-group-id="${e}"]`))}function xt(e,t,n=document){const s=be(e,n).findIndex(o=>o.getAttribute($.resizeHandleId)===t);return s??null}function yt(e,t,n){const r=xt(e,t,n);return r!=null?[r,r+1]:[-1,-1]}function ln(e){return e instanceof HTMLElement?!0:typeof e=="object"&&e!==null&&"tagName"in e&&"getAttribute"in e}function bt(e,t=document){if(ln(t)&&t.dataset.panelGroupId==e)return t;const n=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return n||null}function Ne(e,t=document){const n=t.querySelector(`[${$.resizeHandleId}="${e}"]`);return n||null}function an(e,t,n,r=document){var s,o,i,l;const a=Ne(t,r),h=be(e,r),C=a?h.indexOf(a):-1,p=(s=(o=n[C])===null||o===void 0?void 0:o.id)!==null&&s!==void 0?s:null,c=(i=(l=n[C+1])===null||l===void 0?void 0:l.id)!==null&&i!==void 0?i:null;return[p,c]}function cn({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:r,panelDataArray:s,panelGroupElement:o,setLayout:i}){u.useRef({didWarnAboutMissingResizeHandle:!1}),se(()=>{if(!o)return;const l=be(n,o);for(let a=0;a<s.length-1;a++){const{valueMax:h,valueMin:C,valueNow:p}=sn({layout:r,panelsArray:s,pivotIndices:[a,a+1]}),c=l[a];if(c!=null){const b=s[a];S(b,`No panel data found for index "${a}"`),c.setAttribute("aria-controls",b.id),c.setAttribute("aria-valuemax",""+Math.round(h)),c.setAttribute("aria-valuemin",""+Math.round(C)),c.setAttribute("aria-valuenow",p!=null?""+Math.round(p):"")}}return()=>{l.forEach((a,h)=>{a.removeAttribute("aria-controls"),a.removeAttribute("aria-valuemax"),a.removeAttribute("aria-valuemin"),a.removeAttribute("aria-valuenow")})}},[n,r,s,o]),u.useEffect(()=>{if(!o)return;const l=t.current;S(l,"Eager values not found");const{panelDataArray:a}=l,h=bt(n,o);S(h!=null,`No group found for id "${n}"`);const C=be(n,o);S(C,`No resize handles found for group id "${n}"`);const p=C.map(c=>{const b=c.getAttribute($.resizeHandleId);S(b,"Resize handle element has no handle id attribute");const[m,I]=an(n,b,a,o);if(m==null||I==null)return()=>{};const k=z=>{if(!z.defaultPrevented)switch(z.key){case"Enter":{z.preventDefault();const N=a.findIndex(A=>A.id===m);if(N>=0){const A=a[N];S(A,`No panel data found for index ${N}`);const H=r[N],{collapsedSize:O=0,collapsible:R,minSize:P=0}=A.constraints;if(H!=null&&R){const K=ge({delta:V(H,O)?P-O:O-H,initialLayout:r,panelConstraints:a.map(Q=>Q.constraints),pivotIndices:yt(n,b,o),prevLayout:r,trigger:"keyboard"});r!==K&&i(K)}}break}}};return c.addEventListener("keydown",k),()=>{c.removeEventListener("keydown",k)}});return()=>{p.forEach(c=>c())}},[o,e,t,n,r,s,i])}function tt(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function zt(e,t){const n=e==="horizontal",{x:r,y:s}=Ie(t);return n?r:s}function un(e,t,n,r,s){const o=n==="horizontal",i=Ne(t,s);S(i,`No resize handle element found for id "${t}"`);const l=i.getAttribute($.groupId);S(l,"Resize handle element has no group id attribute");let{initialCursorPosition:a}=r;const h=zt(n,e),C=bt(l,s);S(C,`No group element found for id "${l}"`);const p=C.getBoundingClientRect(),c=o?p.width:p.height;return(h-a)/c*100}function dn(e,t,n,r,s,o){if(at(e)){const i=n==="horizontal";let l=0;e.shiftKey?l=100:s!=null?l=s:l=10;let a=0;switch(e.key){case"ArrowDown":a=i?0:l;break;case"ArrowLeft":a=i?-l:0;break;case"ArrowRight":a=i?l:0;break;case"ArrowUp":a=i?0:-l;break;case"End":a=100;break;case"Home":a=-100;break}return a}else return r==null?0:un(e,t,n,r,o)}function fn({panelDataArray:e}){const t=Array(e.length),n=e.map(o=>o.constraints);let r=0,s=100;for(let o=0;o<e.length;o++){const i=n[o];S(i,`Panel constraints not found for index ${o}`);const{defaultSize:l}=i;l!=null&&(r++,t[o]=l,s-=l)}for(let o=0;o<e.length;o++){const i=n[o];S(i,`Panel constraints not found for index ${o}`);const{defaultSize:l}=i;if(l!=null)continue;const a=e.length-r,h=s/a;r++,t[o]=h,s-=h}return t}function ae(e,t,n){t.forEach((r,s)=>{const o=e[s];S(o,`Panel data not found for index ${s}`);const{callbacks:i,constraints:l,id:a}=o,{collapsedSize:h=0,collapsible:C}=l,p=n[a];if(p==null||r!==p){n[a]=r;const{onCollapse:c,onExpand:b,onResize:m}=i;m&&m(r,p),C&&(c||b)&&(b&&(p==null||ee(p,h))&&!ee(r,h)&&b(),c&&(p==null||!ee(p,h))&&ee(r,h)&&c())}})}function we(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function pn({defaultSize:e,dragState:t,layout:n,panelData:r,panelIndex:s,precision:o=3}){const i=n[s];let l;return i==null?l=e!=null?e.toPrecision(o):"1":r.length===1?l="1":l=i.toPrecision(o),{flexBasis:0,flexGrow:l,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}function mn(e,t=10){let n=null;return(...s)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{e(...s)},t)}}function nt(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,n)=>{localStorage.setItem(t,n)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function vt(e){return`react-resizable-panels:${e}`}function St(e){return e.map(t=>{const{constraints:n,id:r,idIsFromProps:s,order:o}=t;return s?r:o?`${o}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((t,n)=>t.localeCompare(n)).join(",")}function wt(e,t){try{const n=vt(e),r=t.getItem(n);if(r){const s=JSON.parse(r);if(typeof s=="object"&&s!=null)return s}}catch{}return null}function gn(e,t,n){var r,s;const o=(r=wt(e,n))!==null&&r!==void 0?r:{},i=St(t);return(s=o[i])!==null&&s!==void 0?s:null}function hn(e,t,n,r,s){var o;const i=vt(e),l=St(t),a=(o=wt(e,s))!==null&&o!==void 0?o:{};a[l]={expandToSizes:Object.fromEntries(n.entries()),layout:r};try{s.setItem(i,JSON.stringify(a))}catch(h){console.error(h)}}function rt({layout:e,panelConstraints:t}){const n=[...e],r=n.reduce((o,i)=>o+i,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(o=>`${o}%`).join(", ")}`);if(!V(r,100)&&n.length>0)for(let o=0;o<t.length;o++){const i=n[o];S(i!=null,`No layout data found for index ${o}`);const l=100/r*i;n[o]=l}let s=0;for(let o=0;o<t.length;o++){const i=n[o];S(i!=null,`No layout data found for index ${o}`);const l=ue({panelConstraints:t,panelIndex:o,size:i});i!=l&&(s+=i-l,n[o]=l)}if(!V(s,0))for(let o=0;o<t.length;o++){const i=n[o];S(i!=null,`No layout data found for index ${o}`);const l=i+s,a=ue({panelConstraints:t,panelIndex:o,size:l});if(i!==a&&(s-=a-i,n[o]=a,V(s,0)))break}return n}const xn=100,he={getItem:e=>(nt(he),he.getItem(e)),setItem:(e,t)=>{nt(he),he.setItem(e,t)}},ot={};function Pt({autoSaveId:e=null,children:t,className:n="",direction:r,forwardedRef:s,id:o=null,onLayout:i=null,keyboardResizeBy:l=null,storage:a=he,style:h,tagName:C="div",...p}){const c=Ue(o),b=u.useRef(null),[m,I]=u.useState(null),[k,z]=u.useState([]),N=rn(),A=u.useRef({}),H=u.useRef(new Map),O=u.useRef(0),R=u.useRef({autoSaveId:e,direction:r,dragState:m,id:c,keyboardResizeBy:l,onLayout:i,storage:a}),P=u.useRef({layout:k,panelDataArray:[],panelDataArrayChanged:!1});u.useRef({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),u.useImperativeHandle(s,()=>({getId:()=>R.current.id,getLayout:()=>{const{layout:d}=P.current;return d},setLayout:d=>{const{onLayout:y}=R.current,{layout:w,panelDataArray:x}=P.current,f=rt({layout:d,panelConstraints:x.map(v=>v.constraints)});tt(w,f)||(z(f),P.current.layout=f,y&&y(f),ae(x,f,A.current))}}),[]),se(()=>{R.current.autoSaveId=e,R.current.direction=r,R.current.dragState=m,R.current.id=c,R.current.onLayout=i,R.current.storage=a}),cn({committedValuesRef:R,eagerValuesRef:P,groupId:c,layout:k,panelDataArray:P.current.panelDataArray,setLayout:z,panelGroupElement:b.current}),u.useEffect(()=>{const{panelDataArray:d}=P.current;if(e){if(k.length===0||k.length!==d.length)return;let y=ot[e];y==null&&(y=mn(hn,xn),ot[e]=y);const w=[...d],x=new Map(H.current);y(e,w,x,k,a)}},[e,k,a]),u.useEffect(()=>{});const K=u.useCallback(d=>{const{onLayout:y}=R.current,{layout:w,panelDataArray:x}=P.current;if(d.constraints.collapsible){const f=x.map(Y=>Y.constraints),{collapsedSize:v=0,panelSize:L,pivotIndices:_}=oe(x,d,w);if(S(L!=null,`Panel size not found for panel "${d.id}"`),!ee(L,v)){H.current.set(d.id,L);const Z=ce(x,d)===x.length-1?L-v:v-L,D=ge({delta:Z,initialLayout:w,panelConstraints:f,pivotIndices:_,prevLayout:w,trigger:"imperative-api"});we(w,D)||(z(D),P.current.layout=D,y&&y(D),ae(x,D,A.current))}}},[]),Q=u.useCallback((d,y)=>{const{onLayout:w}=R.current,{layout:x,panelDataArray:f}=P.current;if(d.constraints.collapsible){const v=f.map(X=>X.constraints),{collapsedSize:L=0,panelSize:_=0,minSize:Y=0,pivotIndices:Z}=oe(f,d,x),D=y??Y;if(ee(_,L)){const X=H.current.get(d.id),pe=X!=null&&X>=D?X:D,Le=ce(f,d)===f.length-1?_-pe:pe-_,F=ge({delta:Le,initialLayout:x,panelConstraints:v,pivotIndices:Z,prevLayout:x,trigger:"imperative-api"});we(x,F)||(z(F),P.current.layout=F,w&&w(F),ae(f,F,A.current))}}},[]),B=u.useCallback(d=>{const{layout:y,panelDataArray:w}=P.current,{panelSize:x}=oe(w,d,y);return S(x!=null,`Panel size not found for panel "${d.id}"`),x},[]),T=u.useCallback((d,y)=>{const{panelDataArray:w}=P.current,x=ce(w,d);return pn({defaultSize:y,dragState:m,layout:k,panelData:w,panelIndex:x})},[m,k]),j=u.useCallback(d=>{const{layout:y,panelDataArray:w}=P.current,{collapsedSize:x=0,collapsible:f,panelSize:v}=oe(w,d,y);return S(v!=null,`Panel size not found for panel "${d.id}"`),f===!0&&ee(v,x)},[]),q=u.useCallback(d=>{const{layout:y,panelDataArray:w}=P.current,{collapsedSize:x=0,collapsible:f,panelSize:v}=oe(w,d,y);return S(v!=null,`Panel size not found for panel "${d.id}"`),!f||ie(v,x)>0},[]),G=u.useCallback(d=>{const{panelDataArray:y}=P.current;y.push(d),y.sort((w,x)=>{const f=w.order,v=x.order;return f==null&&v==null?0:f==null?-1:v==null?1:f-v}),P.current.panelDataArrayChanged=!0,N()},[N]);se(()=>{if(P.current.panelDataArrayChanged){P.current.panelDataArrayChanged=!1;const{autoSaveId:d,onLayout:y,storage:w}=R.current,{layout:x,panelDataArray:f}=P.current;let v=null;if(d){const _=gn(d,f,w);_&&(H.current=new Map(Object.entries(_.expandToSizes)),v=_.layout)}v==null&&(v=fn({panelDataArray:f}));const L=rt({layout:v,panelConstraints:f.map(_=>_.constraints)});tt(x,L)||(z(L),P.current.layout=L,y&&y(L),ae(f,L,A.current))}}),se(()=>{const d=P.current;return()=>{d.layout=[]}},[]);const E=u.useCallback(d=>{let y=!1;const w=b.current;return w&&window.getComputedStyle(w,null).getPropertyValue("direction")==="rtl"&&(y=!0),function(f){f.preventDefault();const v=b.current;if(!v)return()=>null;const{direction:L,dragState:_,id:Y,keyboardResizeBy:Z,onLayout:D}=R.current,{layout:X,panelDataArray:pe}=P.current,{initialLayout:ve}=_??{},Le=yt(Y,d,v);let F=dn(f,d,L,_,Z,v);const Oe=L==="horizontal";Oe&&y&&(F=-F);const Et=pe.map(It=>It.constraints),me=ge({delta:F,initialLayout:ve??X,panelConstraints:Et,pivotIndices:Le,prevLayout:X,trigger:at(f)?"keyboard":"mouse-or-touch"}),Ke=!we(X,me);(ct(f)||ut(f))&&O.current!=F&&(O.current=F,!Ke&&F!==0?Oe?$e(d,F<0?ft:pt):$e(d,F<0?mt:gt):$e(d,0)),Ke&&(z(me),P.current.layout=me,D&&D(me),ae(pe,me,A.current))}},[]),M=u.useCallback((d,y)=>{const{onLayout:w}=R.current,{layout:x,panelDataArray:f}=P.current,v=f.map(X=>X.constraints),{panelSize:L,pivotIndices:_}=oe(f,d,x);S(L!=null,`Panel size not found for panel "${d.id}"`);const Z=ce(f,d)===f.length-1?L-y:y-L,D=ge({delta:Z,initialLayout:x,panelConstraints:v,pivotIndices:_,prevLayout:x,trigger:"imperative-api"});we(x,D)||(z(D),P.current.layout=D,w&&w(D),ae(f,D,A.current))},[]),W=u.useCallback((d,y)=>{const{layout:w,panelDataArray:x}=P.current,{collapsedSize:f=0,collapsible:v}=y,{collapsedSize:L=0,collapsible:_,maxSize:Y=100,minSize:Z=0}=d.constraints,{panelSize:D}=oe(x,d,w);D!=null&&(v&&_&&ee(D,f)?ee(f,L)||M(d,L):D<Z?M(d,Z):D>Y&&M(d,Y))},[M]),U=u.useCallback((d,y)=>{const{direction:w}=R.current,{layout:x}=P.current;if(!b.current)return;const f=Ne(d,b.current);S(f,`Drag handle element not found for id "${d}"`);const v=zt(w,y);I({dragHandleId:d,dragHandleRect:f.getBoundingClientRect(),initialCursorPosition:v,initialLayout:x})},[]),re=u.useCallback(()=>{I(null)},[]),ze=u.useCallback(d=>{const{panelDataArray:y}=P.current,w=ce(y,d);w>=0&&(y.splice(w,1),delete A.current[d.id],P.current.panelDataArrayChanged=!0,N())},[N]),le=u.useMemo(()=>({collapsePanel:K,direction:r,dragState:m,expandPanel:Q,getPanelSize:B,getPanelStyle:T,groupId:c,isPanelCollapsed:j,isPanelExpanded:q,reevaluatePanelConstraints:W,registerPanel:G,registerResizeHandle:E,resizePanel:M,startDragging:U,stopDragging:re,unregisterPanel:ze,panelGroupElement:b.current}),[K,m,r,Q,B,T,c,j,q,W,G,E,M,U,re,ze]),fe={display:"flex",flexDirection:r==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return u.createElement(Ee.Provider,{value:le},u.createElement(C,{...p,children:t,className:n,id:o,ref:b,style:{...fe,...h},[$.group]:"",[$.groupDirection]:r,[$.groupId]:c}))}const Ct=u.forwardRef((e,t)=>u.createElement(Pt,{...e,forwardedRef:t}));Pt.displayName="PanelGroup";Ct.displayName="forwardRef(PanelGroup)";function ce(e,t){return e.findIndex(n=>n===t||n.id===t.id)}function oe(e,t,n){const r=ce(e,t),o=r===e.length-1?[r-1,r]:[r,r+1],i=n[r];return{...t.constraints,panelSize:i,pivotIndices:o}}function yn({disabled:e,handleId:t,resizeHandler:n,panelGroupElement:r}){u.useEffect(()=>{if(e||n==null||r==null)return;const s=Ne(t,r);if(s==null)return;const o=i=>{if(!i.defaultPrevented)switch(i.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{i.preventDefault(),n(i);break}case"F6":{i.preventDefault();const l=s.getAttribute($.groupId);S(l,`No group element found for id "${l}"`);const a=be(l,r),h=xt(l,t,r);S(h!==null,`No resize element found for id "${t}"`);const C=i.shiftKey?h>0?h-1:a.length-1:h+1<a.length?h+1:0;a[C].focus();break}}};return s.addEventListener("keydown",o),()=>{s.removeEventListener("keydown",o)}},[r,e,t,n])}function kt({children:e=null,className:t="",disabled:n=!1,hitAreaMargins:r,id:s,onBlur:o,onClick:i,onDragging:l,onFocus:a,onPointerDown:h,onPointerUp:C,style:p={},tabIndex:c=0,tagName:b="div",...m}){var I,k;const z=u.useRef(null),N=u.useRef({onClick:i,onDragging:l,onPointerDown:h,onPointerUp:C});u.useEffect(()=>{N.current.onClick=i,N.current.onDragging=l,N.current.onPointerDown=h,N.current.onPointerUp=C});const A=u.useContext(Ee);if(A===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:H,groupId:O,registerResizeHandle:R,startDragging:P,stopDragging:K,panelGroupElement:Q}=A,B=Ue(s),[T,j]=u.useState("inactive"),[q,G]=u.useState(!1),[E,M]=u.useState(null),W=u.useRef({state:T});se(()=>{W.current.state=T}),u.useEffect(()=>{if(n)M(null);else{const le=R(B);M(()=>le)}},[n,B,R]);const U=(I=r?.coarse)!==null&&I!==void 0?I:15,re=(k=r?.fine)!==null&&k!==void 0?k:5;u.useEffect(()=>{if(n||E==null)return;const le=z.current;S(le,"Element ref not attached");let fe=!1;return tn(B,le,H,{coarse:U,fine:re},(y,w,x)=>{if(!w){j("inactive");return}switch(y){case"down":{j("drag"),fe=!1,S(x,'Expected event to be defined for "down" action'),P(B,x);const{onDragging:f,onPointerDown:v}=N.current;f?.(!0),v?.();break}case"move":{const{state:f}=W.current;fe=!0,f!=="drag"&&j("hover"),S(x,'Expected event to be defined for "move" action'),E(x);break}case"up":{j("hover"),K();const{onClick:f,onDragging:v,onPointerUp:L}=N.current;v?.(!1),L?.(),fe||f?.();break}}})},[U,H,n,re,R,B,E,P,K]),yn({disabled:n,handleId:B,resizeHandler:E,panelGroupElement:Q});const ze={touchAction:"none",userSelect:"none"};return u.createElement(b,{...m,children:e,className:t,id:s,onBlur:()=>{G(!1),o?.()},onFocus:()=>{G(!0),a?.()},ref:z,role:"separator",style:{...ze,...p},tabIndex:c,[$.groupDirection]:H,[$.groupId]:O,[$.resizeHandle]:"",[$.resizeHandleActive]:T==="drag"?"pointer":q?"keyboard":void 0,[$.resizeHandleEnabled]:!n,[$.resizeHandleId]:B,[$.resizeHandleState]:T})}kt.displayName="PanelResizeHandle";const Bn=({className:e,...t})=>g.jsx(Ct,{className:xe("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",e),...t}),bn=lt,Un=({withHandle:e,className:t,...n})=>g.jsx(kt,{className:xe("relative flex w-px items-center justify-center bg-gray-200 after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-hidden focus-visible:ring-1 focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...n,children:e&&g.jsx("div",{className:"z-10 flex h-[30px] w-3 items-center justify-center rounded-xs bg-gray-200 text-black hover:bg-gray-300",children:g.jsx(Wt,{className:"size-5"})})});function Wn(e){const{courseSlug:t,moduleTitle:n,lessonTitle:r,onUpgradeClick:s,isDisabled:o,defaultQuestions:i=[],courseAIChatHistory:l,setCourseAIChatHistory:a,onClose:h,isAIChatsOpen:C,setIsAIChatsOpen:p,isGeneratingLesson:c}=e,b=Lt(),m=u.useRef(null),I=u.useRef(null),[k,z]=u.useState(!1),[N,A]=u.useState(""),[H,O]=u.useState(""),{data:R,isLoading:P}=Ve(qe(),Ae),{data:K,isLoading:Q}=Ve(Dt(),Ae),B=(R?.used||0)>=(R?.limit||0),T=K?.status==="active",j=E=>{E.preventDefault();const M=N.trim();if(!M||k||!je()||B||P)return;const W=[...l,{role:"user",content:M}];Se.flushSync(()=>{a(W),A("")}),q(),G(W)},q=u.useCallback(()=>{m.current?.scrollTo({top:m.current.scrollHeight,behavior:"smooth"})},[m]),G=async E=>{z(!0);const M=await fetch(`undefined/v1-follow-up-ai-course/${t}`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({moduleTitle:n,lessonTitle:r,messages:E.slice(-10)})});if(!M.ok){const U=await M.json();b.error(U?.message||"Something went wrong"),a([...E].slice(0,E.length-1)),z(!1),U.status===401&&(jt(),window.location.reload())}const W=M.body?.getReader();if(!W){z(!1),b.error("Something went wrong");return}await At(W,{onStream:async U=>{Se.flushSync(()=>{O(U)}),q()},onStreamEnd:async U=>{const re=[...E,{role:"assistant",content:U,html:await Ht(U)}];Se.flushSync(()=>{O(""),z(!1),a(re)}),Ae.invalidateQueries(qe()),q()}}),z(!1)};return u.useEffect(()=>{q()},[]),g.jsx(bn,{defaultSize:C?30:0,minSize:20,id:"course-chat-content",order:2,className:"relative h-full max-lg:fixed! max-lg:inset-0! max-lg:data-[chat-state=closed]:hidden max-lg:data-[chat-state=open]:flex","data-chat-state":C?"open":"closed",children:g.jsxs("div",{className:"absolute inset-y-0 right-0 z-20 flex w-full flex-col overflow-hidden bg-white data-[state=closed]:hidden data-[state=open]:flex","data-state":C?"open":"closed",children:[g.jsx("button",{onClick:h,className:"absolute top-2 right-2 z-20 hidden rounded-full p-1 text-gray-400 hover:text-black max-lg:block",children:g.jsx(Xe,{className:"size-4 stroke-[2.5]"})}),g.jsxs("div",{className:"flex items-center justify-between gap-2 border-b border-gray-200 px-4 py-2 text-sm",children:[g.jsxs("h4",{className:"flex items-center gap-2 text-base font-medium",children:[g.jsx(st,{className:"relative -top-[1px] size-5 shrink-0 text-black",strokeWidth:2.5}),"AI Instructor"]}),g.jsx("button",{onClick:h,className:"hidden rounded-md px-2 py-2 text-xs font-medium text-gray-500 hover:bg-gray-100 hover:text-black lg:block",children:g.jsx(Xe,{className:"size-4 stroke-[2.5]"})})]}),g.jsx("div",{className:"scrollbar-thumb-gray-300 scrollbar-track-transparent scrollbar-thin relative grow overflow-y-auto",ref:m,children:g.jsx("div",{className:"absolute inset-0 flex flex-col",children:g.jsxs("div",{className:"relative flex grow flex-col justify-end",children:[c&&g.jsx("div",{className:"absolute inset-0 flex items-center justify-center gap-1.5 bg-gray-100",children:g.jsxs("div",{className:"flex items-center gap-1.5 rounded-md border border-gray-200 bg-white px-3 py-1.5",children:[g.jsx(_t,{className:"size-4 text-gray-400",outerFill:"transparent"}),g.jsx("p",{className:"text-sm text-gray-500",children:"Generating lesson..."})]})}),g.jsxs("div",{className:"flex flex-col justify-end gap-2 px-3 py-2",children:[l.map((E,M)=>g.jsxs(u.Fragment,{children:[g.jsx(Te,{role:E.role,content:E.content,html:E.html}),E.isDefault&&i?.length>1&&g.jsxs("div",{className:"mt-0.5 mb-1",children:[g.jsx("p",{className:"mb-2 text-xs font-normal text-gray-500",children:"Some questions you might have about this lesson."}),g.jsx("div",{className:"flex flex-col justify-end gap-1",children:i.map((W,U)=>g.jsx("button",{className:"flex h-full self-start rounded-md bg-yellow-500/10 px-3 py-2 text-left text-sm text-black hover:bg-yellow-500/20",onClick:()=>{Se.flushSync(()=>{A(W)}),I.current?.focus()},children:W},`default-question-${U}`))})]})]},`chat-${M}`)),k&&!H&&g.jsx(Te,{role:"assistant",content:"Thinking..."}),H&&g.jsx(Te,{role:"assistant",content:H})]})]})})}),g.jsxs("form",{className:"relative flex items-start border-t border-gray-200 text-sm",onSubmit:j,children:[B&&je()&&g.jsxs("div",{className:"absolute inset-0 z-10 flex items-center justify-center gap-2 bg-black text-white",children:[g.jsx(Je,{className:"size-4 cursor-not-allowed",strokeWidth:2.5}),g.jsxs("p",{className:"cursor-not-allowed",children:["Limit reached for today",T?". Please wait until tomorrow.":""]}),!T&&g.jsx("button",{onClick:()=>{s()},className:"rounded-md bg-white px-2 py-1 text-xs font-medium text-black hover:bg-gray-300",children:"Upgrade for more"})]}),!je()&&g.jsxs("div",{className:"absolute inset-0 z-10 flex items-center justify-center gap-2 bg-black text-white",children:[g.jsx(Je,{className:"size-4 cursor-not-allowed",strokeWidth:2.5}),g.jsx("p",{className:"cursor-not-allowed",children:"Please login to continue"}),g.jsx("button",{onClick:()=>{Tt()},className:"rounded-md bg-white px-2 py-1 text-xs font-medium text-black hover:bg-gray-300",children:"Login / Register"})]}),g.jsx(Nt,{className:xe("h-full min-h-[41px] grow resize-none bg-transparent px-4 py-2 focus:outline-hidden",o?"cursor-not-allowed opacity-50":"cursor-auto"),placeholder:"Ask AI anything about the lesson...",value:N,onChange:E=>A(E.target.value),autoFocus:!0,onKeyDown:E=>{E.key==="Enter"&&!E.shiftKey&&j(E)},ref:I}),g.jsx("button",{type:"submit",disabled:o||k||B,className:"flex aspect-square size-[41px] items-center justify-center text-zinc-500 hover:text-black disabled:cursor-not-allowed disabled:opacity-50",children:g.jsx(Bt,{className:"size-4 stroke-[2.5]"})})]})]})})}function Te(e){const{role:t,content:n,html:r}=e,s=u.useMemo(()=>r||Mt(n,!1),[n,r]);return g.jsx("div",{className:xe("flex flex-col rounded-lg",t==="user"?"bg-gray-300/30":"bg-yellow-500/30"),children:g.jsxs("div",{className:"flex items-start gap-2.5 p-3",children:[g.jsx("div",{className:xe("flex size-6 shrink-0 items-center justify-center rounded-full",t==="user"?"bg-gray-200 text-black":"bg-yellow-400 text-black"),children:t==="user"?g.jsx(Gt,{className:"size-4 stroke-[2.5]"}):g.jsx(st,{className:"size-4 stroke-[2.5]"})}),g.jsx("div",{className:"course-content course-ai-content prose prose-sm mt-0.5 max-w-full overflow-hidden text-sm",dangerouslySetInnerHTML:{__html:s}})]})})}export{Wn as A,Bn as R,bn as a,Un as b,Te as c};
