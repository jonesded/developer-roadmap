import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.Z3BHPS3u.js";import{s as D,g as E,i as v}from"./jwt.1xGNZsvU.js";import{c as h}from"./classname.y9b8gBZq.js";import{l as P}from"./auth.Blx_4y9V.js";import{c as I}from"./createLucideIcon.BSLrQS80.js";import{U as _}from"./user-round.D2mOPNuO.js";import{U as O}from"./users-round.D8eM98xM.js";import{P as R}from"./plus.CstxCH0M.js";import{M as $}from"./map.DuWy2ZcB.js";import{C as z}from"./chevron-right.B-RYTm0N.js";import{L as G}from"./log-out.DpAdf0Mt.js";import{c as S}from"./team.D9_M1CfW.js";import{a as L,b as T}from"./http.BJhNQusg.js";import{u as C}from"./use-toast.BdCcSTJE.js";import{u as U}from"./index.BlfZEqDn.js";import{C as H}from"./chevron-left.DdnmjL-W.js";import{U as q}from"./users.DjpFdpTD.js";import{u as Y}from"./use-outside-click.DYGsxgbd.js";import{C as B}from"./CreateRoadmapModal.4jjEH5QG.js";import{M as K}from"./Modal.NtjGPDbq.js";import{i as W,p as j}from"./page.DyYQD7MX.js";import{C as J}from"./check.DflWYpXj.js";import{A as Q}from"./arrow-up-right.CWJoE-FU.js";import{u as V}from"./use-scroll-position.GMAhVpOP.js";import{C as X}from"./chevron-down.pBq1owZr.js";import"./js.cookie.Cz0CWeBA.js";import"./index.BHh4vvK5.js";import"./index.3whys8t3.js";import"./fp.esm.CznIeghd.js";import"./toast.DlejBBdi.js";import"./loader-circle.DfB4mNyf.js";import"./use-keydown.r409VyJJ.js";import"./x.BOdyWiWF.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["path",{d:"m11 17 2 2a1 1 0 1 0 3-3",key:"efffak"}],["path",{d:"m14 14 2.5 2.5a1 1 0 1 0 3-3l-3.88-3.88a3 3 0 0 0-4.24 0l-.88.88a1 1 0 1 1-3-3l2.81-2.81a5.79 5.79 0 0 1 7.06-.87l.47.28a2 2 0 0 0 1.42.25L21 4",key:"9pr0kb"}],["path",{d:"m21 3 1 11h-2",key:"1tisrp"}],["path",{d:"M3 3 2 14l6.5 6.5a1 1 0 1 0 3-3",key:"1uvwmv"}],["path",{d:"M3 4h8",key:"1ep09j"}]],ee=I("handshake",Z);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const te=[["path",{d:"M18 21a6 6 0 0 0-12 0",key:"kaz2du"}],["circle",{cx:"12",cy:"11",r:"4",key:"1gt34v"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],se=I("square-user-round",te);function F(m){const{className:s=""}=m;return e.jsxs("span",{className:h("absolute -top-1 right-0 h-3 w-3 text-xs uppercase tracking-wider",s),children:[e.jsx("span",{className:"absolute inline-flex h-full w-full animate-ping rounded-full bg-green-400 opacity-75"}),e.jsx("span",{className:"relative inline-flex h-3 w-3 rounded-full bg-green-500"})]})}function ae(m){const{setIsTeamsOpen:s,onCreateRoadmap:i,onOnboardingClick:l,isConfigLoading:r=!0,shouldShowOnboardingStatus:d=!1,onboardingConfigCount:x,doneConfigCount:u}=m;return e.jsxs("ul",{children:[d&&e.jsx("li",{className:"mb-1 px-1",children:e.jsxs("button",{className:h("flex h-9 w-full items-center rounded-sm py-1 pr-2 pl-3 text-sm font-medium text-slate-100 hover:opacity-80",r?"striped-loader-darker flex border-slate-800 opacity-70":"border-slate-600 bg-slate-700"),onClick:l,disabled:r,children:[e.jsx(F,{className:"-top-0.5 -left-0.5"}),r?e.jsx(e.Fragment,{}):e.jsxs(e.Fragment,{children:[e.jsx(ee,{className:"mr-2 h-4 w-4 text-slate-400 group-hover:text-white"}),e.jsx("span",{children:"Onboarding"}),e.jsxs("span",{className:"ml-auto flex items-center gap-1.5 text-xs text-slate-400",children:[u," of ",x]})]})]})}),e.jsx("li",{className:"px-1",children:e.jsxs("a",{href:"/account",className:"group flex items-center gap-2 rounded-sm py-2 pr-2 pl-3 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(_,{className:"h-4 w-4 stroke-[2.5px] text-slate-400 group-hover:text-white"}),"Account"]})}),e.jsx("li",{className:"px-1",children:e.jsxs("a",{href:"/account/update-profile",className:"group flex items-center justify-between gap-2 rounded-sm py-2 pr-2 pl-3 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx(se,{className:"h-4 w-4 stroke-[2.5px] text-slate-400 group-hover:text-white"}),"My Profile"]}),e.jsx("span",{className:"rounded-xs bg-yellow-300 px-1 text-xs tracking-wide text-black uppercase",children:"New"})]})}),e.jsx("li",{className:"px-1",children:e.jsxs("a",{href:"/account/friends",className:"group flex items-center gap-2 rounded-sm py-2 pr-2 pl-3 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(O,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"Friends"]})}),e.jsx("li",{className:"mt-1 border-t border-t-gray-700/60 px-1 pt-1",children:e.jsxs("button",{onClick:()=>{i()},className:"group flex w-full items-center gap-2 rounded-sm py-2 pr-2 pl-3 text-left text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(R,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"New Roadmap"]})}),e.jsx("li",{className:"border-b border-b-gray-700/60 px-1 pb-1",children:e.jsxs("a",{href:"/account/roadmaps",className:"group flex items-center gap-2 rounded-sm py-2 pr-2 pl-3 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx($,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"Roadmaps"]})}),e.jsx("li",{className:"px-1 pt-1",children:e.jsxs("button",{className:"group flex w-full items-center justify-between rounded-sm py-2 pr-2 pl-3 text-sm font-medium text-slate-100 hover:bg-slate-700",onClick:()=>s(!0),children:[e.jsxs("span",{className:"flex items-center gap-2.5",children:[e.jsx(O,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"Teams"]}),e.jsx(z,{className:"h-4 w-4 shrink-0 stroke-[2.5px] text-slate-400 group-hover:text-white"})]})}),e.jsx("li",{className:"px-1",children:e.jsxs("button",{className:"group flex w-full items-center gap-2 rounded-sm py-2 pr-2 pl-3 text-left text-sm font-medium text-slate-100 hover:bg-slate-700",type:"button",onClick:P,children:[e.jsx(G,{className:"h-4 w-4 stroke-[2px] text-slate-400 group-hover:text-white"}),"Logout"]})})]})}function re(m){const{setIsTeamsOpen:s}=m,i=C(),l=U(S),[r,d]=a.useState(!0);async function x(){if(l.length>0)return;d(!0);const{response:o,error:n}=await L("undefined/v1-get-user-teams");if(n||!o){i.error(n?.message||"Something went wrong");return}S.set(o)}a.useEffect(()=>{x().finally(()=>d(!1))},[]);const u=r&&e.jsxs("div",{className:"mt-2 flex animate-pulse flex-col gap-1 px-1 text-center",children:[e.jsx("div",{className:"h-[35px] rounded-md bg-gray-700"}),e.jsx("div",{className:"h-[35px] rounded-md bg-gray-700"}),e.jsx("div",{className:"h-[35px] rounded-md bg-gray-700"})]});return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between px-2",children:[e.jsx("button",{className:"mt-1 flex h-5 w-5 items-center justify-center rounded-sm text-slate-400 hover:bg-slate-50/10 hover:text-slate-50",onClick:()=>s(!1),children:e.jsx(H,{className:"h-4 w-4 stroke-[2.5px]"})}),e.jsx("a",{className:"mt-1 flex h-5 w-5 items-center justify-center rounded-sm text-slate-400 hover:bg-slate-50/10 hover:text-slate-50",href:"/team/new",children:e.jsx(R,{className:"h-4 w-4 stroke-[2.5px]"})})]}),u,!r&&e.jsxs("ul",{className:"mt-2",children:[l?.map(o=>{let n="";return o.status==="invited"?n=`/respond-invite?i=${o.memberId}`:o.status==="joined"&&(n=`/team/activity?t=${o._id}`),e.jsx("li",{className:"px-1",children:e.jsx("a",{href:n,className:"block truncate rounded-sm px-4 py-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:o.name})},o._id)}),l.length===0&&!r&&e.jsx("li",{className:"mt-2 px-1 text-center",children:e.jsxs("p",{className:"block rounded-sm px-4 py-2 text-sm font-medium text-slate-500",children:[e.jsx(q,{className:"mx-auto mb-2 h-7 w-7 text-slate-600"}),"No teams found."," ",e.jsx("a",{className:"font-medium text-slate-400 underline underline-offset-2 hover:text-slate-300",href:"/team/new",children:"Create a team"}),"."]})})]})]})}const k="should_nudge_onboarding";function oe(m){const{onStartOnboarding:s}=m,[i,l]=a.useState(!1),r=U(W),{y:d}=V();return a.useEffect(()=>{localStorage.getItem(k)===null&&localStorage.setItem(k,"true")},[]),localStorage.getItem(k)!=="true"||d<100||r,null}function ne(m){const{onboardingConfig:s,onClose:i,onIgnoreTask:l}=m,r=C(),[d,x]=a.useState(null),u=a.useMemo(()=>[{id:"updateProgress",title:"Update your Progress",description:"Mark your progress on roadmaps",status:s?.onboarding?.updateProgress||"pending",url:"/roadmaps",urlText:"Roadmaps List"},{id:"publishProfile",title:"Claim a Username",description:"Optionally create a public profile to share your skills",status:s?.onboarding?.publishProfile||"pending",url:"/account/update-profile",urlText:"Update Profile"},{id:"customRoadmap",title:"Custom Roadmaps",description:"Create your own roadmap from scratch",status:s?.onboarding?.customRoadmap||"pending",url:"https://draw.roadmap.sh",urlText:"Create Roadmap"},{id:"addFriends",title:"Invite your Friends",description:"Invite friends to join you on roadmaps",status:s?.onboarding?.addFriends||"pending",url:"/account/friends",urlText:"Add Friends",onClick:()=>{o("addFriends","done","Updating status..").finally(()=>j.set(""))}},{id:"roadCard",title:"Create your Roadmap Card",description:"Embed your skill card on your github or website",status:s?.onboarding?.roadCard||"pending",url:"/account/road-card",urlText:"Create Road Card",onClick:()=>{o("roadCard","done","Updating status..").finally(()=>j.set(""))}},{id:"inviteTeam",title:"Invite your Team",description:"Invite your team to collaborate on roadmaps",status:s?.onboarding?.inviteTeam||"pending",url:"/team/new",urlText:"Create Team"}],[s]),o=async(t,c,g="Ignoring Task")=>{j.set(g);const{response:w,error:f}=await T("undefined/v1-update-onboarding-config",{id:t,status:c});if(f||!w){r.error(f?.message||"Failed to ignore task");return}l?.(t,c),x(null)},n=async()=>{const{response:t,error:c}=await T("undefined/v1-ignore-onboarding-forever",{});if(c||!t){r.error(c?.message||"Failed to ignore onboarding");return}D(t.token),window.location.reload()},b=u.every(t=>t.status==="done"||t.status==="ignored");return a.useEffect(()=>{b&&(j.set("Finishing Onboarding"),n().finally(()=>{}))},[b]),e.jsxs(K,{onClose:i,bodyClassName:"text-black h-auto",children:[e.jsxs("div",{className:"px-4 pb-2 pl-11 pt-4",children:[e.jsx("h2",{className:"mb-0.5 text-xl font-semibold",children:"Welcome to roadmap.sh"}),e.jsx("p",{className:"text-balance text-sm text-gray-500",children:"Complete the tasks below to get started!"})]}),e.jsx("ul",{className:h("flex flex-col divide-y",{"border-b":u[u.length-1]?.status==="done"}),children:u.map((t,c)=>{const g=t.status==="done",w=d?.id===t.id;return e.jsx("li",{"data-active":w,"data-status":t.status,className:h("group/task px-4 py-2.5",{"bg-gray-100":g,"border-t":c===0&&g}),children:e.jsxs("div",{className:h("flex items-start gap-2",{"opacity-50":t.status==="done"}),children:[e.jsx("span",{className:"relative top-px flex h-5 w-5 items-center justify-center",children:g?e.jsx(J,{className:"h-4 w-4 stroke-[3px] text-green-500"}):e.jsx("div",{className:h("h-4 w-4 rounded-md border border-gray-300",t.status==="ignored"?"bg-gray-200":"bg-transparent")})}),e.jsxs("div",{className:"group-data-[status=ignored]/task:text-gray-400",children:[e.jsxs("h3",{className:"flex items-center text-sm font-semibold group-data-[status=done]/task:line-through",children:[t.title,e.jsxs("a",{href:t.url,target:"_blank",className:h("ml-1 inline-block rounded-xl border border-black bg-white pl-1.5 pr-1 text-xs font-normal text-black hover:bg-black hover:text-white"),"aria-label":"Open task in new tab",onClick:()=>{t?.onClick&&t.onClick()},children:[t.urlText,e.jsx(Q,{className:"relative -top-[0.5px] ml-0.5 inline-block h-3.5 w-3.5 stroke-[2px]"})]})]}),e.jsx("p",{className:"text-xs text-gray-500 group-data-[status=ignored]/task:text-gray-400",children:t.description})]})]})},t.id)})}),e.jsxs("div",{className:"mt-2 px-11 pb-5",children:[e.jsx("button",{className:"w-full rounded-md bg-linear-to-r from-purple-500 to-purple-700 px-4 py-2 text-sm font-medium text-white hover:from-purple-500 hover:to-purple-600",onClick:i,children:"Do it later"}),e.jsx("button",{className:"mt-3 text-sm text-gray-500 underline underline-offset-2 hover:text-black",onClick:()=>{j.set("Ignoring Onboarding"),n().finally()},children:"Ignore forever"})]})]})}function ze(){const m=C(),s=a.useRef(null),[i,l]=a.useState(!1),[r,d]=a.useState(!1),[x,u]=a.useState(!1),[o,n]=a.useState(!1),[b,t]=a.useState(!1),[c,g]=a.useState(void 0),f=E()?.onboardingStatus==="pending"||c?.onboardingStatus==="pending",y=async()=>{if(!v()||!f)return;n(!0);const{response:p,error:N}=await L("undefined/v1-get-onboarding-config");(N||!p)&&m.error(N?.message||"Failed to load onboarding config"),g(p)};if(Y(s,()=>{l(!1),d(!1),n(!0)}),a.useEffect(()=>{!v()||!i||y().finally(()=>{n(!1)})},[i]),a.useEffect(()=>{const p=()=>{y().finally(()=>{n(!1)})};return window.addEventListener("visibilitychange",p),()=>{window.removeEventListener("visibilitychange",p)}},[]),!v())return null;const M=Object.values(c?.onboarding||{}).filter(p=>p!=="pending").length,A=Object.keys(c?.onboarding||{}).length;return e.jsxs(e.Fragment,{children:[f&&!b&&e.jsx(oe,{onStartOnboarding:()=>{y().then(()=>{t(!0)})}}),e.jsxs("div",{className:"relative z-90 animate-fade-in",children:[b&&c&&e.jsx(ne,{onboardingConfig:c,onClose:()=>{t(!1)},onIgnoreTask:(p,N)=>{y().finally(()=>{})}}),x&&e.jsx(B,{onClose:()=>{u(!1)}}),e.jsxs("button",{className:"relative flex h-8 w-40 items-center justify-center gap-1.5 rounded-full bg-linear-to-r from-purple-500 to-purple-700 px-4 py-2 text-sm font-medium text-white hover:from-purple-500 hover:to-purple-600",onClick:()=>{d(!1),l(!i)},children:[e.jsxs("span",{className:"inline-flex items-center",children:["Account ",e.jsx("span",{className:"text-gray-300",children:"/"})," Teams"]}),e.jsx(X,{className:"h-4 w-4 shrink-0 stroke-[2.5px]"}),f&&!i&&e.jsx(F,{})]}),i&&e.jsx("div",{ref:s,className:"absolute right-0 z-50 mt-2 min-h-[152px] w-48 rounded-md bg-slate-800 py-1 shadow-xl",children:r?e.jsx(re,{setIsTeamsOpen:d}):e.jsx(ae,{onCreateRoadmap:()=>{u(!0),l(!1)},setIsTeamsOpen:d,onOnboardingClick:()=>{t(!0),l(!1)},shouldShowOnboardingStatus:f,isConfigLoading:o,onboardingConfigCount:A,doneConfigCount:M})})]})]})}export{ze as AccountDropdown};
