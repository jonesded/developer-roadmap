import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.Z3BHPS3u.js";import{a as j}from"./http.BJhNQusg.js";import{R as y}from"./ResourceProgress.EkrxCvT0.js";import{p as d}from"./page.DyYQD7MX.js";import{R as D}from"./RoadmapIcon.x-v-C98i.js";import{A as R}from"./ActivityStream.itmNdBzm.js";import{u as B}from"./use-toast.BdCcSTJE.js";import{P}from"./ProjectProgress.BBTFSXbC.js";import"./js.cookie.Cz0CWeBA.js";import"./fp.esm.CznIeghd.js";import"./jwt.1xGNZsvU.js";import"./use-outside-click.DYGsxgbd.js";import"./use-keydown.r409VyJJ.js";import"./ProgressShareButton.OUQB_89_.js";import"./use-auth.Bw1nhFr_.js";import"./use-copy-text.D2rWbbuk.js";import"./CheckIcon.D4OhQ5l1.js";import"./ShareIcon._wHpzMFh.js";import"./classname.y9b8gBZq.js";import"./ellipsis-vertical.Di0fjBX0.js";import"./createLucideIcon.BSLrQS80.js";import"./x.BOdyWiWF.js";import"./number.DnDLgi2j.js";import"./index.3whys8t3.js";import"./date.2wIYh-wy.js";import"./list.CXlwBFwN.js";import"./Modal.NtjGPDbq.js";import"./arrow-up-right.CWJoE-FU.js";import"./check.DflWYpXj.js";import"./book-open.Dsgc4gH7.js";import"./ActivityTopicTitles.DLMiyJNa.js";import"./toast.DlejBBdi.js";import"./circle-dashed.CWS34pCs.js";import"./thumbs-up.Bh8cJMHm.js";function g(i){const{text:o,count:a}=i;return e.jsxs("div",{className:"relative flex flex-1 flex-row-reverse sm:flex-col px-0 sm:px-4 py-2 sm:py-4 text-center sm:pt-[1.62rem] items-center gap-2 sm:gap-0 justify-end",children:[e.jsx("h2",{className:"text-base sm:text-5xl font-bold",children:a}),e.jsx("p",{className:"mt-0 sm:mt-2 text-sm text-gray-400",children:o})]})}function S(i){const{done:o,learning:a,streak:m}=i;return e.jsx("div",{className:"mx-0 -mt-5 sm:-mx-10 md:-mt-10",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-0 sm:gap-2 divide-y sm:divide-y-0 divide-x-0 sm:divide-x border-b",children:[e.jsx(g,{text:"Topics Completed",count:`${o?.total||0}`}),e.jsx(g,{text:"Currently Learning",count:`${a?.total||0}`}),e.jsx(g,{text:"Visit Streak",count:`${m?.count||0}d`})]})})}function k(){return e.jsx("div",{className:"rounded-md",children:e.jsxs("div",{className:"flex flex-col items-center p-7 text-center",children:[e.jsx(D,{className:"mb-2  h-14 w-14 opacity-10"}),e.jsx("h2",{className:"text-lg sm:text-xl font-bold",children:"No Progress"}),e.jsxs("p",{className:"my-1 sm:my-2 max-w-[400px] text-gray-500 text-sm sm:text-base",children:["Progress will appear here as you start tracking your"," ",e.jsx("a",{href:"/roadmaps",className:"mt-4 text-blue-500 hover:underline",children:"Roadmaps"})," ","or"," ",e.jsx("a",{href:"/best-practices",className:"mt-4 text-blue-500 hover:underline",children:"Best Practices"})," ","progress."]})]})})}function ut(){const i=B(),[o,a]=l.useState(),[m,A]=l.useState(!0),[v,C]=l.useState([]);async function p(){const{error:t,response:s}=await j("https://api.hnmdevs.com/v1-get-user-stats");if(!s||t){console.error("Error loading activity"),console.error(t);return}a(s)}async function w(){const{error:t,response:s}=await j("/pages.json");if(t){i.error(t.message||"Something went wrong");return}if(!s)return[];const r=s.filter(n=>n.group==="Projects");C(r)}l.useEffect(()=>{Promise.allSettled([p(),w()]).finally(()=>{d.set(""),A(!1)})},[]);const f=o?.learning.roadmaps||[],h=o?.learning.bestPractices||[];if(m)return null;const c=f.sort((t,s)=>{const r=new Date(t.updatedAt);return new Date(s.updatedAt).getTime()-r.getTime()}).filter(t=>t.learning>0||t.done>0),u=h.sort((t,s)=>{const r=new Date(t.updatedAt);return new Date(s.updatedAt).getTime()-r.getTime()}).filter(t=>t.learning>0||t.done>0),N=c.length!==0||u.length!==0,x=o?.projects.map(t=>{const s=v.find(r=>r.id===t.projectId);return{...t,title:s?.title||"N/A"}});return e.jsxs(e.Fragment,{children:[e.jsx(S,{done:o?.done||{today:0,total:0},learning:o?.learning||{today:0,total:0},streak:o?.streak||{count:0}}),e.jsxs("div",{className:"mx-0 px-0 py-5 pb-0 md:-mx-10 md:px-8 md:py-8 md:pb-0",children:[c.length===0&&u.length===0&&e.jsx(k,{}),(c.length>0||u.length>0)&&e.jsxs(e.Fragment,{children:[e.jsx("h2",{className:"mb-3 text-xs uppercase text-gray-400",children:"Continue Following"}),e.jsxs("div",{className:"grid grid-cols-1 gap-1.5 sm:grid-cols-2",children:[f.sort((t,s)=>{const r=new Date(t.updatedAt);return new Date(s.updatedAt).getTime()-r.getTime()}).filter(t=>t.learning>0||t.done>0).map(t=>{const s=t.learning||0,r=t.done||0,n=t.total||0,T=t.skipped||0;return e.jsx(y,{isCustomResource:t.isCustomResource,doneCount:r>n?n:r,learningCount:s>n?n:s,totalCount:n,skippedCount:T,resourceId:t.id,resourceType:"roadmap",updatedAt:t.updatedAt,title:t.title,onCleared:()=>{d.set("Updating activity"),p().finally(()=>{d.set("")})}},t.id)}),h.sort((t,s)=>{const r=new Date(t.updatedAt);return new Date(s.updatedAt).getTime()-r.getTime()}).filter(t=>t.learning>0||t.done>0).map(t=>e.jsx(y,{isCustomResource:t.isCustomResource,doneCount:t.done||0,totalCount:t.total||0,learningCount:t.learning||0,resourceId:t.id,skippedCount:t.skipped||0,resourceType:"best-practice",title:t.title,updatedAt:t.updatedAt,onCleared:()=>{d.set("Updating activity"),p().finally(()=>{d.set("")})}},t.id))]})]})]}),x&&x?.length>0&&e.jsxs("div",{className:"mx-0 px-0 py-5 pb-0 md:-mx-10 md:px-8 md:py-8 md:pb-0",children:[e.jsx("h2",{className:"mb-3 text-xs uppercase text-gray-400",children:"Your Projects"}),e.jsx("div",{className:"grid grid-cols-1 gap-1.5 sm:grid-cols-2",children:x.map(t=>e.jsx(P,{projectStatus:t},t._id))})]}),N&&e.jsx(R,{activities:o?.activities||[]})]})}export{ut as ActivityPage};
