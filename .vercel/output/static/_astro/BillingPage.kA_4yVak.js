import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as h}from"./index.Z3BHPS3u.js";import{p as S}from"./page.DyYQD7MX.js";import{u as P}from"./use-toast.BdCcSTJE.js";import{u as M,q as y}from"./query-client.zrB8z_yM.js";import{u as E}from"./useMutation.BxVH4XRI.js";import{b as L,U as B}from"./billing.D5yrowA9.js";import{a as I}from"./query-http.BQfMbvYq.js";import{U as A}from"./UpgradeAccountModal.fZmxo5nD.js";import{g as D}from"./browser.3c2kCsRM.js";import{V as T}from"./VerifyUpgrade.ButUjaV5.js";import{C as w}from"./credit-card.bcfoan7u.js";import{Z as R}from"./zap.BNbCfd_G.js";import{M as _}from"./message-circle.C1uJbl19.js";import{S as F}from"./sparkles.DB73Rui2.js";import{H as V}from"./heart-handshake.ChP6KiKS.js";import{E as H}from"./ellipsis.BcvtAoad.js";import{T as O}from"./triangle-alert.D3x2YB55.js";import{c as Y}from"./classname.y9b8gBZq.js";import{C as N}from"./circle-x.BL3YVBBU.js";import{C as q}from"./circle-alert.DQNBwVc5.js";import{c as C}from"./createLucideIcon.BSLrQS80.js";import{C as z}from"./calendar.DJD-aIIP.js";import{L as W}from"./loader-circle.DfB4mNyf.js";import"./index.3whys8t3.js";import"./toast.DlejBBdi.js";import"./jwt.1xGNZsvU.js";import"./js.cookie.Cz0CWeBA.js";import"./fp.esm.CznIeghd.js";import"./Modal.NtjGPDbq.js";import"./use-outside-click.DYGsxgbd.js";import"./use-keydown.r409VyJJ.js";import"./x.BOdyWiWF.js";import"./UpdatePlanConfirmation.CPFKRCnq.js";import"./map.DuWy2ZcB.js";import"./circle-check-big.CnV0y9bI.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Z=C("arrow-right-left",$);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],X=C("refresh-cw",Q),G=[{icon:R,text:"Unlimited AI course generations"},{icon:_,text:"Unlimited AI Chat feature usage"},{icon:F,text:"Early access to new features"},{icon:V,text:"Support the development of platform"},{icon:H,text:"more perks coming soon!"}];function b(o){const{onUpgrade:n}=o;return e.jsxs("div",{className:"mt-12 flex h-full w-full flex-col items-center",children:[e.jsx(w,{className:"mb-3 h-12 w-12 text-gray-300"}),e.jsx("h3",{className:"mb-3 text-xl font-semibold text-black",children:"No Active Subscription"}),e.jsx("p",{className:"text-balance text-gray-700",children:"Unlock pro benefits by upgrading to a subscription"}),e.jsx("div",{className:"my-8 flex flex-col gap-2",children:G.map(t=>e.jsxs("p",{className:"textsm flex items-center text-gray-600",children:[e.jsx(t.icon,{className:"mr-2 h-4 w-4 text-gray-500"}),t.text]},t.text))}),e.jsx("button",{onClick:n,className:"inline-flex items-center justify-center rounded-lg bg-black px-6 py-2.5 text-sm font-medium text-white transition-colors hover:opacity-80 focus:outline-hidden focus:ring-2 focus:ring-black focus:ring-offset-2",children:"Upgrade Account"})]})}function x(o){const{message:n,onButtonClick:t,buttonText:c,isLoading:u,icon:s=O}=o;return e.jsxs("div",{className:"mb-6 flex items-center gap-2 rounded-lg border border-red-300 bg-red-50 p-4 text-sm text-red-600",children:[e.jsx(s,{className:"h-5 w-5"}),e.jsxs("span",{children:[n,c&&e.jsx("button",{disabled:u,onClick:()=>{t?.()},className:"font-semibold underline underline-offset-4 disabled:cursor-not-allowed disabled:opacity-50 ml-0.5",children:c})]})]})}function De(){const o=P(),[n,t]=h.useState(!1),[c,u]=h.useState(!1),{data:s,isPending:p}=M(L(),y),m=s?.cancelAtPeriodEnd,k=s?.status==="canceled",v=s?.status==="past_due",f=s?.status==="incomplete",U=s?.status==="incomplete_expired",{mutate:l,isSuccess:a,isPending:i}=E({mutationFn:r=>I("/v1-create-customer-portal",r),onSuccess:r=>{window.location.href=r.url},onError:r=>{console.error(r),o.error(r?.message||"Failed to Create Customer Portal")}},y);if(h.useEffect(()=>{if(p)return;S.set(""),D()?.s==="1"&&u(!0)},[p]),p||!s)return null;const g=B.find(r=>r.priceId===s?.priceId),j=new Date(s?.currentPeriodEnd||"").toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}),d=e.jsxs(e.Fragment,{children:[n&&e.jsx(A,{onClose:()=>{t(!1)}}),c&&e.jsx(T,{})]});return s?.status==="none"||U?e.jsxs(e.Fragment,{children:[d,e.jsx(b,{onUpgrade:()=>t(!0)})]}):k?e.jsxs(e.Fragment,{children:[d,e.jsx(x,{icon:N,message:"Your subscription has been canceled.",buttonText:"Reactivate?",onButtonClick:()=>{m?l({}):t(!0)},isLoading:i||a}),e.jsx(b,{onUpgrade:()=>t(!0)})]}):f?e.jsxs(e.Fragment,{children:[d,e.jsx(x,{icon:q,message:"Your subscription is incomplete ",buttonText:"please pay invoice on Stripe.",onButtonClick:()=>{l({})},isLoading:i||a}),e.jsx(b,{onUpgrade:()=>t(!0)})]}):g?e.jsxs(e.Fragment,{children:[d,e.jsxs("div",{className:"mt-1",children:[v&&e.jsx(x,{message:"We were not able to charge your card.",buttonText:"Update payment information.",onButtonClick:()=>{l({})},isLoading:i||a}),m&&e.jsx(x,{icon:N,message:`Your subscription will be canceled on ${j}. `,buttonText:"Reactivate?",onButtonClick:()=>{l({})},isLoading:i||a}),e.jsx("h2",{className:"mb-2 text-xl font-semibold text-black",children:"Current Subscription"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Thank you for being a pro member. Your plan details are below."}),e.jsx("div",{className:"mt-8 flex flex-col gap-6 sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-gray-100",children:e.jsx(X,{className:"size-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs tracking-wider text-gray-400 uppercase",children:"Payment"}),e.jsxs("h3",{className:"flex items-baseline text-lg font-semibold text-black",children:["$",g.amount,e.jsxs("span",{className:"ml-1 text-sm font-normal text-gray-500",children:["/ ",g.interval]})]})]})]})}),e.jsxs("div",{className:Y("mt-6 pt-6",!f&&"border-t border-gray-100",f&&"-mt-6"),children:[e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex h-12 w-12 items-center justify-center rounded-full bg-gray-100",children:e.jsx(z,{className:"size-5 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("span",{className:"text-xs tracking-wider text-gray-400 uppercase",children:m?"Expires On":"Renews On"}),e.jsx("h3",{className:"text-lg font-semibold text-black",children:j})]})]}),e.jsxs("div",{className:"mt-8 flex gap-3 max-sm:flex-col",children:[!m&&e.jsxs("button",{className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-xs transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-black focus:ring-offset-2 focus:outline-hidden max-sm:grow",onClick:()=>{t(!0)},children:[e.jsx(Z,{className:"mr-2 h-4 w-4"}),"Switch Plan"]}),e.jsxs("button",{className:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-xs transition-colors hover:bg-gray-50 focus:ring-2 focus:ring-black focus:ring-offset-2 focus:outline-hidden disabled:cursor-not-allowed disabled:opacity-50",onClick:()=>{l({})},disabled:i||a,children:[i||a?e.jsx(W,{className:"mr-2 h-4 w-4 animate-spin"}):e.jsx(w,{className:"mr-2 h-4 w-4"}),"Manage Subscription"]})]})]})]})]}):e.jsxs("div",{className:"p-5",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"Uh oh!"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["We couldn't find your subscription details. Please contact support at",e.jsx("a",{className:"text-blue-500 underline",href:"mailto:info@roadmap.sh",children:"info@roadmap.sh"}),"."]})]})}export{De as BillingPage};
