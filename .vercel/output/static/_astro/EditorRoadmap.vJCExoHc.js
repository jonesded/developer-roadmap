import{j as l}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.Z3BHPS3u.js";import{_ as j}from"./preload-helper.BlTxHScW.js";/* empty css                       */import{a as D,u as b,r as I,b as P,c as T}from"./resource-progress.BKggaGKm.js";import{p as k}from"./page.DyYQD7MX.js";import{u as C}from"./use-toast.BdCcSTJE.js";import{s as _}from"./slugger.rj1cS6co.js";import{i as v}from"./jwt.1xGNZsvU.js";import{s as y}from"./popup.CdCAhVM2.js";import{S as N}from"./Spinner.CPY-6wbR.js";import{a as G}from"./http.BJhNQusg.js";import{g as $}from"./browser.3c2kCsRM.js";import{R as A}from"./RoadmapFloatingChat.DyFansb3.js";import"./js.cookie.Cz0CWeBA.js";import"./roadmap.DwTTnFhR.js";import"./index.BHh4vvK5.js";import"./index.3whys8t3.js";import"./toast.DlejBBdi.js";import"./fp.esm.CznIeghd.js";import"./query-client.zrB8z_yM.js";import"./index.BlPpvBlM.js";import"./index.Bbp-6C1p.js";import"./use-keydown.r409VyJJ.js";import"./ListChatHistory.CxCxA8VL.js";import"./query-http.Bohx3EqF.js";import"./markdown.CL3gtrVM.js";/* empty css                          */import"./classname.y9b8gBZq.js";import"./use-copy-text.D2rWbbuk.js";import"./Tooltip.CCudSue-.js";import"./check.DflWYpXj.js";import"./createLucideIcon.BSLrQS80.js";import"./copy.CgTXj779.js";import"./Modal.NtjGPDbq.js";import"./use-outside-click.DYGsxgbd.js";import"./x.BOdyWiWF.js";import"./chevron-down.pBq1owZr.js";import"./useMutation.BxVH4XRI.js";import"./loader-circle.DfB4mNyf.js";import"./message-circle.C1uJbl19.js";import"./index.browser.OxPLOBIU.js";import"./ai-course.m2sFB2uK.js";import"./roadmap-tree.CTIkvlIr.js";import"./number.DnDLgi2j.js";import"./CheckIcon.D4OhQ5l1.js";import"./chevron-right.B-RYTm0N.js";import"./use-auth.Bw1nhFr_.js";import"./share.CLihwtJm.js";import"./index.Dgut0sTl.js";import"./chat.C-0TRz4N.js";import"./circle-alert.DQNBwVc5.js";import"./is-mobile.CWj1ep7V.js";import"./datetime.BHfGb2kO.js";import"./use-debounce.CXZLeMbB.js";import"./search.CUAljTEc.js";import"./DropdownMenu.DLecQPzF.js";import"./Combination.CkJeYjFl.js";import"./floating-ui.dom.BG6dflv2.js";import"./circle.D81F4kBU.js";import"./ellipsis-vertical.Di0fjBX0.js";import"./trash-2.CIQaIo_h.js";import"./plus.CstxCH0M.js";import"./lock.C0C-BW9S.js";import"./dom.B_TnKQIa.js";import"./billing.Dog7Gwv_.js";import"./UpgradeAccountModal.Bl29I556.js";import"./UpdatePlanConfirmation.NT5hFl0c.js";import"./VerifyUpgrade.B0n18ihL.js";import"./circle-check-big.CnV0y9bI.js";import"./zap.BNbCfd_G.js";import"./map.DuWy2ZcB.js";import"./UpdatePersonaModal.BTkCXbpe.js";import"./user-round.D2mOPNuO.js";import"./bot.CQ2bIWO6.js";import"./Popover.j-Qljcb0.js";import"./TopicDetail.DY0BfPvF.js";import"./GitHubIcon.NZCYHAdm.js";import"./vue.BIhB9hsv.js";import"./transition.MUZrSsh7.js";import"./head.CbjsIJ-A.js";import"./earth.ApD3nwNq.js";import"./wand-sparkles.8eLpe3am.js";import"./react-textarea-autosize.browser.esm.CREEQHIU.js";import"./ai.DmXEK0i3.js";import"./AICourseLessonChat.TSA60raE.js";/* empty css                        */import"./send.BVE6djDn.js";import"./AILimitsPopup.D5_oZcjJ.js";import"./gift.C1ExsHI3.js";import"./list.CXlwBFwN.js";import"./star.B-cQRnHp.js";import"./book-open-text.BTmii8Os.js";import"./brain.DU33CjMf.js";import"./file-text.BpqfdBL4.js";import"./heart-handshake.ChP6KiKS.js";import"./ban.BRPE8iYC.js";import"./book-open.Dsgc4gH7.js";import"./person-standing.DxKAUQm4.js";const B=a.lazy(()=>j(()=>import("./index.Dgut0sTl.js"),[]).then(m=>({default:m.Renderer})));function w(m){const e=m?.closest("g")||{},f=e?.dataset?.nodeId,p=e?.dataset?.type,i=e?.dataset?.title;return!f||!p?null:{nodeId:f,nodeType:p,targetGroup:e,title:i}}const x=["topic","subtopic","button","link-item","resourceButton","todo","todo-checkbox","checklist-item"];function K(m){const{resourceId:e,nodes:f=[],edges:p=[]}=m,i=a.useRef(null),R=C();async function c(t,s){k.set("Updating progress"),b({resourceId:e,resourceType:"roadmap",topicId:t},s).then(()=>{I(t,s)}).catch(o=>{R.error("Something went wrong, please try again."),console.error(o)}).finally(()=>{k.set(""),P()})}const g=a.useCallback(t=>{const s=t.target,{nodeId:o,nodeType:r,targetGroup:n,title:d}=w(s)||{};if(!o||!r||!x.includes(r))return;if(r==="button"||r==="link-item"||r==="resourceButton"){const u=n?.dataset?.link||"";u.startsWith("http")?window.open(u,"_blank"):window.location.href=u;return}const L=n?.classList.contains("learning"),E=n?.classList.contains("skipped");if(r==="todo-checkbox"){if(t.preventDefault(),!v()){y();return}const u=n?.classList.contains("done")?"pending":"done";c(o,u);return}if(t.shiftKey){if(t.preventDefault(),!v()){y();return}c(o,L?"pending":"learning");return}else if(t.altKey){if(t.preventDefault(),!v()){y();return}c(o,E?"pending":"skipped");return}if(r==="checklist-item"&&s.tagName==="rect"){if(t.preventDefault(),!v()){y();return}const u=n?.classList.contains("done")?"pending":"done";c(o,u);return}if(r==="checklist-item"||!d)return;const S=`${_(d)}@${o}`;window.dispatchEvent(new CustomEvent("roadmap.node.click",{detail:{topicId:S,resourceId:e,resourceType:"roadmap"}}))},[]),h=a.useCallback(t=>{t.preventDefault();const s=t.target,{nodeId:o,nodeType:r,targetGroup:n}=w(s)||{};if(!o||!r||!x.includes(r)||r==="button")return;if(!v()){y();return}const d=n?.classList.contains("done");c(o,d?"pending":"done")},[]);return a.useEffect(()=>{if(i?.current)return i?.current?.addEventListener("click",g),i?.current?.addEventListener("contextmenu",h),()=>{i?.current?.removeEventListener("click",g),i?.current?.removeEventListener("contextmenu",h)}},[]),l.jsx(B,{ref:i,roadmap:{nodes:f,edges:p},onRendered:()=>{i.current?.setAttribute("data-renderer","editor"),D("roadmap",e).finally()}})}function Cr(m){const{resourceId:e,resourceType:f="roadmap",dimensions:p}=m,[i,R]=a.useState(!1),[c,g]=a.useState(!0),[h,t]=a.useState(void 0),s=async()=>{g(!0);const{r}=$(),{response:n,error:d}=await G(`undefined/v1-official-roadmap/${r||e}`);if(d){console.error(d);return}t(n),g(!1),R(!!r)};a.useEffect(()=>{T(f,e),s().finally()},[e]);const o=p.width/p.height;return!h||c?l.jsx("div",{style:i?void 0:{"--aspect-ratio":o},className:"mt-5 flex aspect-[var(--aspect-ratio)] w-full flex-col justify-center",children:l.jsx("div",{className:"flex w-full justify-center",children:l.jsx(N,{className:"h-6 w-6 animate-spin sm:h-12 sm:w-12",isDualRing:!1})})}):l.jsxs("div",{style:i?void 0:{"--aspect-ratio":o},className:"mt-5 flex aspect-[var(--aspect-ratio)] w-full flex-col justify-center",children:[l.jsx(K,{...h,dimensions:p,resourceId:e}),l.jsx(A,{roadmapId:e})]})}export{Cr as EditorRoadmap};
