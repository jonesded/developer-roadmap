import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as l}from"./index.Z3BHPS3u.js";import{u as D}from"./use-toast.BdCcSTJE.js";import{a as E,h as M}from"./http.BJhNQusg.js";import{c as O}from"./createLucideIcon.BSLrQS80.js";import{g as U}from"./date.2wIYh-wy.js";import{P as T}from"./Pagination.DomnIFR-.js";import{g as B,s as H,d as P}from"./browser.3c2kCsRM.js";import{p as C}from"./page.DyYQD7MX.js";import{M as _}from"./Modal.NtjGPDbq.js";import{A as F}from"./arrow-up-right.CWJoE-FU.js";import{i as z}from"./jwt.1xGNZsvU.js";import{s as G}from"./popup.CdCAhVM2.js";import{u as V}from"./use-outside-click.DYGsxgbd.js";import{C as $}from"./chevron-down.pBq1owZr.js";import{X as W}from"./x.BOdyWiWF.js";import{S as q}from"./search.CUAljTEc.js";import{V as R,T as K}from"./VoteButton.BdTppozA.js";import{G as Q}from"./GitHubIcon.NZCYHAdm.js";import{T as X}from"./thumbs-up.Bh8cJMHm.js";import"./toast.DlejBBdi.js";import"./index.3whys8t3.js";import"./js.cookie.Cz0CWeBA.js";import"./fp.esm.CznIeghd.js";import"./classname.y9b8gBZq.js";import"./number.DnDLgi2j.js";import"./ellipsis.BcvtAoad.js";import"./use-keydown.r409VyJJ.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=[["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["path",{d:"M10 21V8a1 1 0 0 0-1-1H4a1 1 0 0 0-1 1v12a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-5a1 1 0 0 0-1-1H3",key:"1fpvtg"}]],J=O("blocks",Y);function Z(){const a=e.jsxs("li",{className:"flex min-h-[78px] animate-pulse flex-wrap items-center justify-between overflow-hidden rounded-md bg-gray-200 sm:min-h-[44px] sm:animate-none sm:rounded-none sm:bg-transparent",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx("span",{className:"block h-[28px] w-[28px] animate-pulse rounded-full bg-gray-200"}),e.jsx("span",{className:"ml-2 block h-[26px] w-[350px] animate-pulse rounded-full bg-gray-200"})]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"animated-pulse h-[26px] w-[80px] rounded-full bg-gray-200"}),e.jsx("span",{className:"animated-pulse h-[26px] w-[113px] rounded-full bg-gray-200"})]})]});return e.jsxs("ul",{className:"flex min-h-[500px] flex-col gap-2 divide-y sm:gap-0",children:[a,a,a,a,a,a,a,a,a,a,a]})}function ee(a){const{projectId:s}=a;return e.jsxs("div",{className:"flex min-h-[250px] flex-col items-center justify-center rounded-xl px-5 py-3 sm:px-0 sm:py-20 bg-white border mb-5",children:[e.jsx(J,{className:"mb-4 opacity-10 h-14 w-14"}),e.jsx("h2",{className:"mb-1 text-lg font-semibold sm:text-xl",children:"No solutions submitted yet"}),e.jsx("p",{className:"mb-3 text-balance text-center text-xs text-gray-400 sm:text-sm",children:"Be the first to submit a solution for this project"}),e.jsx("div",{className:"flex flex-col items-center gap-1 sm:flex-row sm:gap-1.5",children:e.jsx("a",{href:`/projects/${s}`,className:"flex w-full items-center gap-1.5 rounded-md bg-gray-900 px-3 py-1.5 text-xs text-white sm:w-auto sm:text-sm",children:"View Project Details"})})]})}function te(a){const{onClose:s,repositoryUrl:p}=a;return e.jsxs(_,{onClose:s,bodyClassName:"h-auto p-4",children:[e.jsx("h2",{className:"mb-1.5 text-2xl font-semibold",children:"Leaving roadmap.sh"}),e.jsx("p",{className:"text-sm text-gray-500",children:"You are about to visit the project solution on GitHub. We recommend you to follow these tips before you leave."}),e.jsxs("div",{className:"my-3",children:[e.jsxs("p",{className:"rounded-lg bg-gray-200 p-2 text-sm text-gray-900",children:["Make sure to come back and"," ",e.jsx("span",{className:"font-medium text-purple-600",children:"leave an upvote"})," ","if you liked the solution. It helps the author and the community."]}),e.jsxs("p",{className:"mt-1 rounded-lg bg-gray-200 p-2 text-sm text-gray-900",children:["If you have feedback on the solution, open an issue or a pull request on the"," ",e.jsx("span",{className:"font-medium text-purple-600",children:"solution repository"}),"."]}),e.jsxs("p",{className:"mt-1 rounded-lg bg-gray-200 p-2 text-sm text-gray-900",children:["Downvote the solution if it is"," ",e.jsx("span",{className:"font-medium text-purple-600",children:"incorrect or misleading"}),". It helps the community."]})]}),e.jsxs("a",{className:"inline-flex w-full items-center gap-2 rounded-lg bg-black px-3 py-2.5 text-sm text-white",href:p,target:"_blank",children:[e.jsx(F,{className:"h-5 w-5"}),"Continue to Solution"]})]})}function se(a){const{projectId:s,onSelectLanguage:p,selectedLanguage:d}=a,r=l.useRef(null),c=l.useRef(null),m=l.useRef(null),i=D(),[x,N]=l.useState([]),[h,b]=l.useState(!1),[S,y]=l.useState(""),[v,f]=l.useState(0),j=x.filter(t=>t.toLowerCase().includes(S.toLowerCase()));l.useEffect(()=>{if(!h||!m.current)return;const n=m.current.getElementsByTagName("button")[v];if(!n)return;const g=m.current.getBoundingClientRect(),u=n.getBoundingClientRect(),w=u.top<g.top,A=u.bottom>g.bottom;(w||A)&&n.scrollIntoView({block:"nearest",behavior:"instant"})},[v,h]);const k=async()=>{const{response:t,error:n}=await E(`undefined/v1-list-project-languages/${s}`);if(n||!t){i.error(n?.message||"Failed to load project languages");return}N(t)};V(r,()=>{b(!1),y(""),f(0)}),l.useEffect(()=>{k().finally(()=>{})},[]),l.useEffect(()=>{h&&c.current&&c.current.focus()},[h]);const o=t=>{switch(t.key){case"ArrowDown":t.preventDefault(),f(n=>n>=j.length-1?0:n+1);break;case"ArrowUp":t.preventDefault(),f(n=>n<=0?j.length-1:n-1);break;case"Enter":t.preventDefault(),j[v]&&(p(j[v]),b(!1),y(""),f(0));break;case"Escape":b(!1),y(""),f(0);break}};return e.jsxs("div",{className:"relative flex shrink-0",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{className:"flex items-center gap-1 rounded-md border border-gray-300 py-1.5 pl-3 pr-2 text-xs font-medium text-gray-900",onClick:()=>b(!h),children:[d||"Select Language",e.jsx($,{className:"ml-1 h-4 w-4"})]}),d&&e.jsxs("button",{className:"absolute -right-1.5 -top-1.5 flex h-4 w-4 items-center justify-center rounded-full bg-red-500 text-white hover:bg-red-600",onClick:t=>{t.stopPropagation(),p("")},children:[e.jsx(W,{className:"size-3",strokeWidth:2.5}),e.jsx("span",{className:"sr-only",children:"Clear selection"})]})]}),h&&e.jsxs("div",{className:"absolute right-0 top-full z-10 w-full min-w-[200px] max-w-[200px] translate-y-1.5 overflow-hidden rounded-md border border-gray-300 bg-white p-1 shadow-lg",ref:r,onKeyDown:o,children:[e.jsxs("div",{className:"relative mb-1 px-1",children:[e.jsx(q,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-gray-400"}),e.jsx("input",{ref:c,type:"text",className:"w-full rounded-md border border-gray-200 py-1.5 pl-9 pr-3 text-sm focus:border-gray-300 focus:outline-hidden",placeholder:"Search languages...",value:S,onChange:t=>{y(t.target.value),f(0)}})]}),e.jsxs("div",{ref:m,className:"max-h-[200px] overflow-y-auto",children:[j.map((t,n)=>{const g=d===t,u=n===v;return e.jsx("button",{className:`flex w-full items-center rounded-md px-4 py-1.5 text-left text-sm text-gray-700 hover:bg-gray-100 aria-selected:bg-gray-100 ${u?"bg-gray-100":""}`,onClick:()=>{p(t),b(!1),y(""),f(0)},"aria-selected":g,children:t},t)}),j.length===0&&e.jsx("div",{className:"px-4 py-2 text-sm text-gray-500",children:"No languages found"})]})]})]})}const L=[{label:"Latest First",value:"latest"},{label:"Oldest First",value:"oldest"},{label:"Highest Rating",value:"rating"}];function ae(a){const{selectedSort:s,onSelectSort:p}=a,[d,r]=l.useState(!1),c=l.useRef(null);V(c,()=>{r(!1)});const m=L.find(i=>i.value===s)||L[0];return e.jsxs("div",{className:"relative shrink-0",ref:c,children:[e.jsxs("button",{className:"flex items-center gap-1 rounded-md border border-gray-300 py-1.5 pl-3 pr-2 text-xs font-medium text-gray-900",onClick:()=>r(!d),children:[m.label,e.jsx($,{className:"ml-1 h-4 w-4"})]}),d&&e.jsx("div",{className:"absolute right-0 top-full z-10 mt-1.5 min-w-[150px] overflow-hidden rounded-md border border-gray-300 bg-white shadow-lg",children:e.jsx("div",{className:"py-1",children:L.map(i=>e.jsx("button",{className:`flex w-full items-center px-4 py-1.5 text-left text-sm text-gray-700 hover:bg-gray-100 ${s===i.value?"bg-gray-100":""}`,onClick:()=>{p(i.value),r(!1)},children:i.label},i.value))})})]})}const I=["submitted their solution","got it done","submitted their take","finished the project","submitted their work","completed the project","got it done","delivered their project","handed in their solution","provided their deliverables","submitted their approach","sent in their project","presented their take","shared their completed task","submitted their approach","completed it","finalized their solution","delivered their approach","turned in their project","submitted their final draft","delivered their solution"];function re(a){const{solution:s,counter:p,onVote:d,onVisitSolution:r,onLanguageClick:c}=a,m=s.user.avatar||"";return e.jsxs("div",{className:"group flex flex-col border-gray-100 px-3 py-2.5 text-sm hover:bg-gray-50/50 sm:flex-row sm:justify-between",children:[e.jsxs("div",{className:"flex min-w-0 items-start gap-3",children:[e.jsx("img",{src:m?`undefined/${m}`:"/images/default-avatar.png",alt:s.user.name,className:"h-7 w-7 shrink-0 rounded-full sm:h-8 sm:w-8"}),e.jsxs("div",{className:"min-w-0 flex-auto",children:[e.jsxs("div",{className:"flex flex-wrap items-baseline gap-x-1.5 gap-y-0.5",children:[e.jsx("span",{className:"max-w-[150px] truncate font-medium text-gray-900 sm:max-w-[180px]",children:s.user.name}),e.jsx("span",{className:"hidden truncate text-xs text-gray-500 sm:block sm:text-sm",children:I[p%I.length]||"submitted their solution"}),e.jsxs("span",{className:"text-xs text-gray-400",title:new Date(s?.submittedAt).toLocaleString(),children:["Â· ",U(s?.submittedAt)]})]}),e.jsxs("div",{className:"mt-2.5 flex gap-1.5",children:[e.jsx("div",{className:"flex gap-1",children:e.jsxs("span",{className:"flex shrink-0 overflow-hidden rounded-full border",children:[e.jsx(R,{icon:X,isActive:s?.voteType==="upvote",count:s.upvotes||0,onClick:()=>{d(s._id,"upvote")}}),e.jsx(R,{icon:K,isActive:s?.voteType==="downvote",count:s.downvotes||0,hideCount:!0,onClick:()=>{d(s._id,"downvote")}})]})}),e.jsxs("button",{className:"flex items-center gap-1 rounded-full border px-2 py-1 text-xs text-black transition-colors hover:border-black hover:bg-black hover:text-white",onClick:()=>{r(s)},children:[e.jsx(Q,{className:"h-3.5 w-3.5 text-current"}),e.jsx("span",{children:"Visit Solution"})]})]})]})]}),e.jsx("div",{className:"mt-2.5 hidden sm:mt-0 sm:block sm:pl-4",children:s.languages&&s.languages.length>0&&e.jsx("div",{className:"flex flex-wrap items-center gap-1.5",children:s.languages.slice(0,2).map(i=>e.jsx("button",{onClick:()=>c?.(i),className:"inline-flex items-center rounded-md border border-gray-200 bg-white px-2 py-0.5 text-xs font-medium text-gray-700 transition-colors hover:border-gray-300 hover:bg-gray-50 hover:text-gray-900",children:i},i))})})]})}function Ve(a){const{projectId:s,project:p}=a,d=D(),[r,c]=l.useState({currentPage:0,language:"",sort:"rating"}),[m,i]=l.useState(!0),[x,N]=l.useState(),[h,b]=l.useState(null),S=async(o=1,t="",n="rating")=>{const{response:g,error:u}=await E(`undefined/v1-list-project-solutions/${s}`,{currPage:o,...t?{languages:t}:{},sort:n});if(u||!g){d.error(u?.message||"Failed to load project solutions"),i(!1);return}N(g)},y=async(o,t)=>{if(!z()){G();return}C.set("Submitting vote");const{response:n,error:g}=await M(`undefined/v1-vote-project/${o}`,{voteType:t});if(g||!n){d.error(g?.message||"Failed to submit vote"),C.set("");return}C.set(""),N(u=>u&&{...u,data:u.data.map(w=>w._id===o?{...w,upvotes:n?.upvotes||0,downvotes:n?.downvotes||0,voteType:t}:w)})};if(l.useEffect(()=>{const o=B();c({currentPage:+(o.p||"1"),language:o.l||"",sort:o.s||"rating"})},[]),l.useEffect(()=>{i(!0),r.currentPage&&(r.currentPage!==1||r.language!==""||r.sort!=="rating"?H({p:String(r.currentPage),l:r.language,s:r.sort}):(P("p"),P("l"),P("s")),S(r.currentPage,r.language,r.sort).finally(()=>{i(!1)}))},[r]),x?.data.length===0)return e.jsx(ee,{projectId:s});const f=h?e.jsx(te,{onClose:()=>b(null),repositoryUrl:h?.repositoryUrl}):null,j=r.language,k=o=>{c(t=>({...t,language:t.language===o?"":o}))};return e.jsxs("div",{className:"mb-4 overflow-hidden rounded-lg border bg-white p-3 sm:p-5",children:[f,e.jsxs("div",{className:"relative mb-5 hidden items-center justify-between sm:flex",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"mb-1 text-xl font-semibold",children:[p.title," Solutions"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Solutions submitted by the community"})]}),!m&&e.jsxs("div",{className:"flex shrink-0 items-center gap-2",children:[e.jsx(ae,{selectedSort:r.sort,onSelectSort:o=>{c(t=>({...t,sort:o}))}}),e.jsx(se,{projectId:s,selectedLanguage:j,onSelectLanguage:o=>{c(t=>({...t,language:t.language===o?"":o}))}})]})]}),m?e.jsx(Z,{}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"flex min-h-[500px] flex-col divide-y divide-gray-100",children:x?.data.map((o,t)=>e.jsx(re,{solution:o,counter:t,onVote:y,onVisitSolution:b,onLanguageClick:k},o._id))}),(x?.totalPages||0)>1&&e.jsx("div",{className:"mt-4",children:e.jsx(T,{totalPages:x?.totalPages||1,currPage:x?.currPage||1,perPage:x?.perPage||21,totalCount:x?.totalCount||0,onPageChange:o=>{c({...r,currentPage:o})}})})]})]})}export{Ve as ListProjectSolutions};
