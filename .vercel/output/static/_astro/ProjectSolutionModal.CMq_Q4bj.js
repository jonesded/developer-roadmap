import{j as t}from"./jsx-runtime.D_zvdyIk.js";import{r as s}from"./index.Z3BHPS3u.js";import{u as S}from"./use-toast.BdCcSTJE.js";import{g as T,d as P}from"./browser.3c2kCsRM.js";import{g as $}from"./date.2wIYh-wy.js";import{a as C,h as L}from"./http.BJhNQusg.js";import{i as M}from"./jwt.1xGNZsvU.js";import{s as U}from"./popup.CdCAhVM2.js";import{p as m}from"./page.DyYQD7MX.js";import{M as A}from"./Modal.NtjGPDbq.js";import{G as I}from"./GitHubIcon.NZCYHAdm.js";import{M as k}from"./ModalLoader.BJqnisCv.js";import{V as h,T as E}from"./VoteButton.BdTppozA.js";import{A as G}from"./arrow-up-right.CWJoE-FU.js";import{T as V}from"./thumbs-up.Bh8cJMHm.js";import"./toast.DlejBBdi.js";import"./index.3whys8t3.js";import"./js.cookie.Cz0CWeBA.js";import"./fp.esm.CznIeghd.js";import"./use-outside-click.DYGsxgbd.js";import"./use-keydown.r409VyJJ.js";import"./classname.y9b8gBZq.js";import"./x.BOdyWiWF.js";import"./createLucideIcon.BSLrQS80.js";import"./ErrorIcon.BTBCVae1.js";import"./Spinner.CPY-6wbR.js";function dt(j){const{projectId:v,projectTitle:w,projectDescription:b}=j,{u:l}=T();if(!l)return null;const y=S(),[d,a]=s.useState(!0),[c,u]=s.useState(""),[e,p]=s.useState(),N=async()=>{a(!0),u("");const{response:r,error:o}=await C(`undefined/v1-project-solution/${v}/${l}`);if(o||!r){u(o?.message||"Something went wrong"),a(!1);return}p(r),a(!1)},f=async(r,o)=>{if(!M()){U();return}m.set("Submitting vote");const{response:i,error:g}=await L(`undefined/v1-vote-project/${r}`,{voteType:o});if(g||!i){y.error(g?.message||"Failed to submit vote"),m.set("");return}m.set(""),p(n=>n&&{...n,upvotes:i?.upvotes||0,downvotes:i?.downvotes||0,voteType:o})};if(s.useEffect(()=>{N().finally()},[]),d||c)return t.jsx(k,{text:"Loading project solution...",isLoading:d,error:c});const x=e?.user.avatar;return t.jsx(A,{onClose:()=>{P("u"),window.location.reload()},wrapperClassName:"max-w-lg",bodyClassName:"h-auto",children:t.jsxs("div",{className:"relative p-6",children:[t.jsx("h1",{className:"mb-1 text-balance text-2xl font-bold text-gray-900",children:w}),t.jsx("p",{className:"text-balance text-sm text-gray-600",children:b}),t.jsx("div",{className:"my-5 rounded-lg bg-gray-100 p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("img",{src:x?`undefined/${x}`:"/images/default-avatar.png",alt:e?.user?.name,className:"h-12 w-12 rounded-full border-2 border-white shadow-md"}),t.jsxs("div",{children:[t.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:[e?.user.name,"'s Solution"]}),t.jsxs("p",{className:"text-sm text-gray-600",children:["Submitted their solution"," ",$(e?.submittedAt)]})]})]})}),t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("a",{className:"flex items-center gap-2 rounded-full bg-black px-4 py-2 text-sm font-medium text-white transition-colors hover:bg-gray-800",href:e?.repositoryUrl,target:"_blank",children:[t.jsx(I,{className:"h-5 w-5 text-current"}),"View Solution on GitHub",t.jsx(G,{className:"h-4 w-4"})]}),t.jsxs("div",{className:"flex overflow-hidden rounded-full border",children:[t.jsx(h,{icon:V,isActive:e?.voteType==="upvote",count:e?.upvotes||0,onClick:()=>f(e?.id,"upvote")}),t.jsx(h,{icon:E,isActive:e?.voteType==="downvote",count:e?.downvotes||0,hideCount:!0,onClick:()=>f(e?.id,"downvote")})]})]})]})})}export{dt as ProjectSolutionModal};
