import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as a}from"./index.Z3BHPS3u.js";import{c as u}from"./classname.y9b8gBZq.js";import{i as re}from"./is-mobile.CWj1ep7V.js";import{C as A}from"./check.DflWYpXj.js";import{h as T,a as oe}from"./http.BJhNQusg.js";import{M as R}from"./Modal.NtjGPDbq.js";import{g as ee}from"./date.2wIYh-wy.js";import{S as ie}from"./Spinner.CPY-6wbR.js";import{C as z}from"./CheckIcon.D4OhQ5l1.js";import{u as M}from"./use-copy-text.D2rWbbuk.js";import{S as ne,F as _}from"./server-crash.HXmtFCvs.js";import{C as H}from"./copy.CgTXj779.js";import{g as te,i as X}from"./jwt.1xGNZsvU.js";import{s as Y}from"./popup.CdCAhVM2.js";import{G as ae}from"./GitHubIcon.NZCYHAdm.js";import{C as ce}from"./circle-dashed.CWS34pCs.js";import{X as le}from"./x.BOdyWiWF.js";import{L as de}from"./loader-circle.DfB4mNyf.js";import{C as me}from"./circle-check-big.CnV0y9bI.js";import{p as J}from"./page.DyYQD7MX.js";import{c as pe}from"./createLucideIcon.BSLrQS80.js";import{S as K}from"./share.CLihwtJm.js";import{P as ue}from"./play.-yCdF7S0.js";import{S as xe}from"./send.BVE6djDn.js";import"./js.cookie.Cz0CWeBA.js";import"./fp.esm.CznIeghd.js";import"./use-outside-click.DYGsxgbd.js";import"./use-keydown.r409VyJJ.js";import"./index.3whys8t3.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],fe=pe("square",he);function W(i){const{status:t,isLoading:r=!1,children:n}=i;return e.jsxs("div",{className:u("flex items-center rounded-lg p-2 text-sm text-gray-900",{"bg-gray-200":t==="pending","bg-green-200":t==="success","bg-red-200":t==="error"}),children:[!r&&e.jsx(e.Fragment,{children:t==="pending"?e.jsx(ce,{className:"h-4 w-4 shrink-0 text-gray-400"}):t==="success"?e.jsx(A,{className:"h-4 w-4 shrink-0 text-green-800"}):e.jsx(le,{className:"h-4 w-4 shrink-0 text-yellow-800"})}),r&&e.jsx(de,{className:"h-4 w-4 animate-spin text-gray-400",strokeWidth:3}),e.jsx("span",{className:"ml-2",children:n})]})}function ge(i,t=0){const[r,n]=a.useState(!1);return a.useEffect(()=>{if(re())return;const o=()=>{i.current&&n(i.current.getBoundingClientRect().top<=t)};return window.addEventListener("scroll",o),()=>{window.removeEventListener("scroll",o)}},[i,t]),r}function Q(i){const{isActive:t,onClick:r=()=>null,isCompleted:n,icon:o,text:l,number:m}=i;return t?e.jsxs("button",{onClick:r,className:"flex items-center gap-1.5 rounded-full bg-purple-600 py-1 pl-2 pr-2.5 text-sm text-white hover:bg-purple-700",children:[e.jsx(o,{size:13}),e.jsx("span",{children:l})]}):n?e.jsxs("span",{className:"flex cursor-default items-center gap-1.5 text-sm font-medium text-green-600",children:[e.jsx(A,{size:14,strokeWidth:3}),e.jsx("span",{children:l})]}):e.jsxs("span",{className:"flex cursor-default items-center gap-1.5 text-sm text-gray-400",children:[e.jsx("span",{className:"flex h-5 w-5 items-center justify-center rounded-full bg-gray-400/70 text-xs text-white",children:m}),e.jsx("span",{children:l})]})}function G(i){const{isActive:t}=i;return e.jsx("hr",{className:u("grow hidden sm:flex border border-gray-300",{"border-green-500":t})})}function Z(i){const{icon:t,text:r,isActive:n=!1,isCompleted:o}=i;return n?e.jsxs("span",{className:"flex cursor-default items-center gap-1.5 rounded-md border border-dashed border-current px-1.5 py-0.5 text-sm font-medium text-gray-400",children:[e.jsx(t,{size:14}),e.jsx("span",{children:r})]}):o?e.jsxs("span",{className:"flex cursor-default items-center gap-1.5 text-sm font-medium text-green-600",children:[e.jsx(A,{size:14,strokeWidth:3}),e.jsx("span",{children:r})]}):e.jsxs("span",{className:"flex cursor-default items-center gap-1.5 text-sm text-gray-400",children:[e.jsx(t,{size:14}),e.jsx("span",{children:r})]})}function je(i){const{onClose:t,startedAt:r,onStarted:n,projectId:o}=i,[l,m]=a.useState(!0),[p,f]=a.useState(),{isCopied:b,copyText:g}=M(),v=`undefined/projects/${o}`,w=r?ee(r):"";async function j(){if(!o||r)return;m(!0);const{response:S,error:s}=await T(`https://api.imoogleai.xyz/v1-start-project/${o}`,{});if(s||!S){f(s?.message||"Failed to start project"),m(!1);return}n(S.startedAt)}return a.useEffect(()=>{j().finally(()=>m(!1))},[]),p?e.jsx(R,{onClose:t,bodyClassName:"h-auto text-red-500",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 pt-12 pb-10",children:[e.jsx(ne,{className:"h-6 w-6"}),e.jsx("p",{className:"font-medium",children:p})]})}):l?e.jsx(R,{onClose:t,bodyClassName:"h-auto",children:e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 pt-12 pb-10",children:[e.jsx(ie,{className:"h-6 w-6",isDualRing:!1}),e.jsx("p",{className:"font-medium",children:"Starting project .."})]})}):e.jsxs(R,{onClose:t,bodyClassName:"h-auto p-4 relative overflow-hidden",wrapperClassName:"max-w-md",children:[e.jsxs("p",{className:"-mx-4 -mt-4 flex items-center bg-yellow-200 px-3 py-2 text-sm text-yellow-900",children:[e.jsx(z,{additionalClasses:"mr-1.5 w-[15px] text-yellow-800 h-[15px]"}),e.jsx("span",{className:"mr-1.5 font-normal",children:"Project started"})," ",e.jsx("span",{className:"font-semibold",children:w})]}),e.jsx("h2",{className:"mt-5 mb-1 text-2xl font-semibold text-gray-800",children:"Start Building"}),e.jsx("p",{className:"text-gray-700",children:"Follow these steps to complete the project."}),e.jsxs("div",{className:"my-5 space-y-1.5 marker:text-gray-400",children:[e.jsx("p",{className:"mt-1 rounded-lg bg-gray-200 p-2 text-sm text-gray-900",children:"1. Create a new public repository on GitHub."}),e.jsx("p",{className:"mt-1 rounded-lg bg-gray-200 p-2 text-sm text-gray-900",children:"2. Complete the project according to the requirements and push your code to the GitHub repository."}),e.jsxs("p",{className:"mt-1 rounded-lg bg-gray-200 p-2 text-sm text-gray-900",children:["3. Add a README file with instructions to run the project and the"," ",e.jsxs("button",{onClick:()=>{g(v)},className:"font-semibold",children:[!b&&e.jsxs("span",{className:"text-purple-600",children:["project page URL",e.jsx(H,{className:"relative -top-px ml-1 inline-block h-4 w-4",strokeWidth:2.5})]}),b&&e.jsxs(e.Fragment,{children:["copied URL",e.jsx(A,{className:"inline-block h-4 w-4",strokeWidth:2.5})]})]})]}),e.jsx("p",{className:"mt-1 rounded-lg bg-gray-200 p-2 text-sm text-gray-900",children:"4. Once done, submit your solution to help the others learn and get feedback from the community."})]}),e.jsx("div",{className:"mb-5",children:e.jsxs("p",{className:"text-sm",children:["If you get stuck, you can always ask for help in the community"," ",e.jsx("a",{href:"https://roadmap.sh/discord",target:"_blank",className:"font-medium underline underline-offset-2",children:"chat on discord"}),"."]})}),e.jsx("button",{className:"w-full rounded-md bg-black py-2 text-sm font-medium text-white hover:bg-gray-900",onClick:t,children:"Close"})]})}function ye(i){const t=Object.values(i).reduce((o,l)=>o+l,0);let r=0,n=[];for(const[o,l]of Object.entries(i))if(r+=l,n.push(o),r/t>=.9)break;return n}function be(i){const{onClose:t,projectId:r}=i,n=te(),o=`https://roadmap.sh/projects/${r}/solutions?u=${n?.id}`,{isCopied:l,copyText:m}=M();return e.jsx(R,{onClose:t,bodyClassName:"h-auto p-4",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pb-3 pt-12",children:[e.jsx(z,{additionalClasses:"h-12 text-green-500 w-12"}),e.jsx("p",{className:"mt-4 text-lg font-medium",children:"Solution Submitted"}),e.jsx("p",{className:"mt-0.5 text-center text-sm text-gray-500",children:"Congrats! Your solution has been submitted."}),e.jsxs("div",{className:"mt-4 w-full",children:[e.jsx("input",{type:"text",readOnly:!0,value:o,className:"w-full rounded-md border bg-gray-50 px-2.5 py-2 text-sm text-gray-700 focus:outline-hidden",onClick:p=>{p.currentTarget.select()}}),e.jsx("button",{className:u("mt-2 flex w-full items-center justify-center gap-1 rounded-md px-2 py-2 text-sm font-medium transition-colors",l?"bg-green-600 text-white hover:bg-green-700":"bg-black text-white hover:bg-gray-800"),onClick:()=>{m(o)},children:l?e.jsxs(e.Fragment,{children:[e.jsx(me,{className:"size-4 stroke-[2.5px]"}),"URL Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(H,{className:"size-4 stroke-[2.5px]"}),"Copy Shareable Link"]})})]})]})})}function we(i){const{onClose:t,projectId:r,onSubmit:n,repositoryUrl:o=""}=i,{isCopied:l,copyText:m}=M(),[p,f]=a.useState(!1),[b,g]=a.useState(""),[v,w]=a.useState(!1),[j,S]=a.useState(o),[s,c]=a.useState({repositoryExists:o?"success":"pending",readmeExists:o?"success":"pending",projectUrlExists:o?"success":"pending"}),L=`https://roadmap.sh/projects/${r}`,C=async d=>{d.preventDefault();try{if(c({repositoryExists:"pending",readmeExists:"pending",projectUrlExists:"pending"}),f(!0),g(""),w(!1),!j)throw c({repositoryExists:"error",readmeExists:"pending",projectUrlExists:"pending"}),new Error("Repository URL is required");const y=j.replace(/https?:\/\/(www\.)?github\.com/,"").split("/"),k=y[1],$=y[2];if(!k||!$)throw c({repositoryExists:"error",readmeExists:"pending",projectUrlExists:"pending"}),new Error("Invalid GitHub repository URL");const E=`https://api.github.com/repos/${k}/${$}`,x=`${E}/contents`,h=await fetch(x);if(!h.ok)throw c({repositoryExists:"error",readmeExists:"pending",projectUrlExists:"pending"}),h?.status===404?new Error("Repository not found. Make sure it exists and is public."):new Error("Failed to fetch repository contents");const N=await h.json();if(!Array.isArray(N))throw c({repositoryExists:"error",readmeExists:"pending",projectUrlExists:"pending"}),new Error("Failed to fetch repository contents");const U=N.find(I=>I.name.toLowerCase()==="readme.md");if(!U||!U.url)throw c({repositoryExists:"success",readmeExists:"error",projectUrlExists:"pending"}),new Error("Readme file not found");const P=U.url,D=await fetch(P);if(!D.ok||D.status===404)throw c({repositoryExists:"success",readmeExists:"error",projectUrlExists:"pending"}),new Error("Readme file not found");const q=await D.json();if(!q.content)throw c({repositoryExists:"success",readmeExists:"error",projectUrlExists:"pending"}),new Error("Readme file not found");if(!window.atob(q.content).includes(L))throw c({repositoryExists:"success",readmeExists:"success",projectUrlExists:"error"}),new Error("Add the project page URL to the readme file");c({repositoryExists:"success",readmeExists:"success",projectUrlExists:"success"});const O=await fetch(`${E}/languages`);let F=[];if(O.ok){const I=await O.json();F=ye(I),F?.length===0&&(F=Object.keys(I||{})?.slice(0,4))}const se=`https://api.imoogleai.xyz/v1-submit-project/${r}`,{response:V,error:B}=await T(se,{repositoryUrl:j,languages:F});if(B||!V)throw new Error(B?.message||"Error submitting project. Please try again!");w(!0),f(!1),n(V)}catch(y){console.error(y),g(y?.message||"Failed to verify repository"),f(!1)}};return v?e.jsx(be,{projectId:r,onClose:t}):e.jsxs(R,{onClose:t,bodyClassName:"h-auto p-4",children:[e.jsxs("h2",{className:"mb-2 flex items-center gap-2.5 text-xl font-semibold",children:[e.jsx(ae,{className:"h-6 w-6 text-black"})," Submit Solution URL"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Submit the URL of your GitHub repository with the solution."}),e.jsxs("div",{className:"my-4 flex flex-col gap-1",children:[e.jsx(W,{isLoading:p,status:s.repositoryExists,children:"URL must point to a public GitHub repository"}),e.jsx(W,{isLoading:p,status:s.readmeExists,children:"Repository must contain a README file"}),e.jsxs(W,{isLoading:p,status:s.projectUrlExists,children:["README file must contain the"," ",e.jsxs("button",{className:"font-medium underline underline-offset-2 hover:text-purple-700",onClick:()=>{m(L)},children:[!l&&e.jsxs(e.Fragment,{children:["project URL"," ",e.jsx(H,{className:"relative -top-0.5 inline-block h-3 w-3",strokeWidth:2.5})]}),l&&e.jsxs(e.Fragment,{children:["copied URL"," ",e.jsx(A,{className:"relative -top-0.5 inline-block h-3 w-3",strokeWidth:2.5})]})]})]})]}),e.jsxs("form",{className:"mt-4",onSubmit:C,children:[e.jsx("input",{type:"text",className:"w-full rounded-lg border border-gray-300 p-2 text-sm focus:border-gray-500 focus:outline-hidden",placeholder:"https://github.com/you/solution-repo",value:j,onChange:d=>S(d.target.value)}),e.jsx("button",{type:"submit",className:"mt-2 w-full rounded-lg bg-black p-2 text-sm font-medium text-white disabled:opacity-50",disabled:p,children:p?"Verifying...":"Verify and Submit"}),b&&e.jsx("p",{className:"mt-2 text-sm font-medium text-red-500",children:b})]})]})}function Ze(i){const{projectId:t}=i,r=a.useRef(null),n=ge(r,8),o=te(),[l,m]=a.useState(!1),[p,f]=a.useState(!1),{copyText:b,isCopied:g}=M(),[v,w]=a.useState(!1),[j,S]=a.useState(null),[s,c]=a.useState(0),[L,C]=a.useState(!0),[d,y]=a.useState({upvotes:0,downvotes:0});async function k(){C(!0);const{response:x,error:h}=await oe(`https://api.imoogleai.xyz/v1-project-status/${t}`,{});if(h||!x){S(h?.message||"Error loading project status"),C(!1);return}const{startedAt:N,submittedAt:U,upvotes:P}=x;P>=10?c(4):P>=5?c(3):U?c(2):N&&c(1),y(x),C(!1)}const $=async()=>{w(!0);const{response:x,error:h}=await T(`https://api.imoogleai.xyz/v1-stop-project/${t}`,{});if(h||!x){w(!1),S(h?.message||"Error stopping project");return}J.set("Update project status"),c(0),k().finally(()=>{J.set(""),w(!1)})};a.useEffect(()=>{k().finally(()=>{})},[]);const E=`https://roadmap.sh/projects/${t}/solutions?u=${o?.id}`;return e.jsxs("div",{ref:r,className:u("relative top-0 -mx-4 my-5 overflow-hidden rounded-none border border-x-0 bg-white transition-all sm:sticky sm:mx-0 sm:rounded-lg sm:border-x",{"sm:-mx-5 sm:rounded-none sm:border-x-0 sm:border-t-0 sm:bg-gray-50":n}),children:[p&&e.jsx(we,{onClose:()=>f(!1),projectId:t,onSubmit:x=>{const{repositoryUrl:h,submittedAt:N}=x;y({...d,repositoryUrl:h,submittedAt:N}),c(2)},repositoryUrl:d.repositoryUrl}),l&&e.jsx(je,{projectId:t,onStarted:x=>{y({...d,startedAt:x}),c(1)},startedAt:d?.startedAt,onClose:()=>m(!1)}),j&&e.jsx("div",{className:"absolute inset-0 bg-red-100 p-2 text-sm text-red-500",children:j}),L&&e.jsx("div",{className:u("striped-loader absolute inset-0 z-10 bg-white")}),e.jsxs("div",{className:u("bg-gray-100 px-4 py-2 text-sm text-gray-500 transition-colors sm:flex sm:items-center",{"bg-purple-600 text-white":n}),children:[s===0&&e.jsx(e.Fragment,{children:"Start building, submit solution and get feedback from the community."}),s===1&&e.jsxs(e.Fragment,{children:["Started working ",e.jsx("span",{className:u("font-medium text-gray-800",{"text-purple-200":n}),children:ee(d.startedAt)}),". Follow ",e.jsx("button",{className:u("underline underline-offset-2 hover:text-black",{"text-purple-100 hover:text-white":n}),onClick:()=>{m(!0)},children:"these tips"})," to get most out of it."]}),s>=2&&e.jsxs(e.Fragment,{children:["Congrats on submitting your solution. ",e.jsx("button",{className:u("underline underline-offset-2 hover:text-black",{"text-purple-100 hover:text-white":n}),onClick:()=>{f(!0)},children:"View or update your submission."})]}),d?.startedAt&&!d?.submittedAt&&e.jsxs("button",{className:u("ml-auto hidden items-center gap-1.5 text-sm hover:text-black disabled:opacity-50 sm:flex"),onClick:$,disabled:v,children:[e.jsx(fe,{className:"h-3 w-3 fill-current stroke-[2.5px]"}),e.jsx("span",{className:"hidden md:inline",children:"Stop Working"}),e.jsx("span",{className:"md:hidden",children:"Stop"})]}),s>=2&&e.jsx("button",{className:u("ml-auto hidden items-center gap-1 text-sm sm:flex",g?"text-green-500":""),onClick:()=>{b(E)},children:g?e.jsxs(e.Fragment,{children:[e.jsx(z,{additionalClasses:"h-3 w-3"}),"Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-3 w-3 stroke-[2.5px]"}),e.jsx("span",{className:"hidden md:inline",children:"Share your Solution"}),e.jsx("span",{className:"md:hidden",children:"Share"})]})})]}),e.jsxs("div",{className:"flex min-h-[60px] flex-col items-start justify-between gap-2 px-4 py-4 sm:flex-row sm:items-center sm:gap-3 sm:py-0",children:[e.jsx(Q,{isActive:s===0,isCompleted:s>0,icon:ue,text:s>0?"Started Working":"Start Working",number:1,onClick:()=>{if(!X()){Y();return}m(!0)}}),e.jsx(G,{isActive:s>0}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Q,{isActive:s===1,isCompleted:s>1,icon:xe,onClick:()=>{if(!X()){Y();return}f(!0)},text:s>1?"Submitted":"Submit Solution",number:2}),s>1&&e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"text-gray-600 sm:hidden",children:"·"}),e.jsx("button",{className:u("flex items-center gap-2 text-sm sm:hidden",g?"text-green-500":"text-gray-600"),onClick:()=>{b(E)},children:g?e.jsxs(e.Fragment,{children:[e.jsx(z,{additionalClasses:"h-3 w-3"}),"URL Copied"]}):e.jsxs(e.Fragment,{children:[e.jsx(K,{className:"h-3 w-3 stroke-[2.5px]"}),"Share your Solution"]})})]})]}),e.jsx(G,{isActive:s>1}),e.jsx(Z,{isActive:s===2,isCompleted:s>2,icon:_,text:s==2?`${d.upvotes} / 5 upvotes`:"5 upvotes"}),e.jsx(G,{isActive:s>2}),e.jsx(Z,{isActive:s===3,isCompleted:s>3,icon:_,text:s==3?`${d.upvotes} / 10 upvotes`:s>3?`${d.upvotes} upvotes`:"10 upvotes"})]})]})}export{Ze as ProjectStepper};
