import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as p}from"./index.Z3BHPS3u.js";import{d as C,a as M}from"./http.BJhNQusg.js";import{p as j}from"./page.DyYQD7MX.js";import{C as I}from"./CreateRoadmapModal.802rVFjq.js";import{u as w}from"./use-toast.BdCcSTJE.js";import{u as L}from"./use-outside-click.DYGsxgbd.js";import{M as _}from"./MoreVerticalIcon.C41XtKgl.js";import{E as U}from"./ellipsis-vertical.Di0fjBX0.js";import{L as N}from"./lock.C0C-BW9S.js";import{S as R}from"./shapes.Dk0DUUzC.js";import{T as D}from"./trash-2.CIQaIo_h.js";import{S as P}from"./ShareOptionsModal.Kq9xiyRx.js";import{R as z}from"./RoadmapIcon.x-v-C98i.js";import{S as F}from"./square-pen.CCkK4Twl.js";import{E as S}from"./external-link.J5OYJvOa.js";import{U as v}from"./users.DjpFdpTD.js";import{G as T}from"./globe.B6R113av.js";import{c as $}from"./runtime.qgnuanK_.js";import{M as A}from"./map.DuWy2ZcB.js";import{u as E}from"./billing.D5yrowA9.js";import{U as O}from"./UpgradeAccountModal.fZmxo5nD.js";function V(n){const{onDelete:s,onUpdateSharing:o,onCustomize:i}=n,a=p.useRef(null),[r,t]=p.useState(!1);return L(a,()=>{t(!1)}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{disabled:!1,onClick:()=>t(!r),className:"hidden items-center opacity-60 transition-opacity hover:opacity-100 disabled:cursor-not-allowed disabled:opacity-30 sm:flex",children:e.jsx(_,{className:"h-4 w-4"})}),e.jsxs("button",{disabled:!1,onClick:()=>t(!r),className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-hidden sm:hidden",children:[e.jsx(U,{size:14}),"Options"]}),r&&e.jsx("div",{ref:a,className:"align-right absolute right-auto top-full z-50 mt-1 w-[140px] rounded-md bg-slate-800 px-2 py-2 text-white shadow-md sm:right-0",children:e.jsxs("ul",{children:[o&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{t(!1),o()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(N,{size:14,className:"mr-2"}),"Sharing"]})}),i&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{t(!1),i()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(R,{size:14,className:"mr-2"}),"Customize"]})}),s&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{t(!1),s()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(D,{size:14,className:"mr-2"}),"Delete"]})})]})})]})}function B(n){const{roadmaps:s,onDelete:o,setAllRoadmaps:i,onUpgrade:a,maxLimit:r=-1}=n,t=w(),[l,g]=p.useState(null);async function u(d){const{response:x,error:m}=await C(`https://api.roadmap.sh/v1-delete-roadmap/${d}`);if(m||!x){console.error(m),t.error(m?.message||"Something went wrong, please try again");return}t.success("Roadmap deleted"),o(d)}async function h(d){j.set("Deleting roadmap"),u(d).finally(()=>{j.set("")})}const b=l&&e.jsx(P,{roadmapSlug:l?.slug,isDiscoverable:l.isDiscoverable,description:l.description,visibility:l.visibility,sharedFriendIds:l.sharedFriendIds,sharedTeamMemberIds:l.sharedTeamMemberIds,roadmapId:l._id,onClose:()=>g(null),onShareSettingsUpdate:d=>{i(x=>({...x,personalRoadmaps:x.personalRoadmaps.map(m=>m._id===l._id?{...m,...d}:m)}))}});return s.length===0?e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[e.jsx(z,{className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:"Create a roadmap to get started"})]}):e.jsxs("div",{children:[b,e.jsxs("div",{className:"mb-3 flex items-center text-sm text-gray-400",children:[r===-1&&e.jsxs(e.Fragment,{children:[s.length," custom roadmap(s)"]}),r!==-1&&e.jsxs(e.Fragment,{children:[s.length," of ",r," roadmaps"," ",e.jsx("button",{onClick:a,className:"ml-2 text-blue-600 underline underline-offset-2 hover:text-blue-700",children:"Need more? Upgrade"})]})]}),e.jsx("ul",{className:"flex flex-col divide-y rounded-md border",children:s.map(d=>e.jsx(G,{roadmap:d,onRemove:h,setSelectedRoadmap:g},d._id))})]})}function G(n){const{roadmap:s,onRemove:o,setSelectedRoadmap:i}=n,a=`https://draw.roadmap.sh/${s._id}`;return e.jsxs("li",{className:"grid grid-cols-1 p-2.5 sm:grid-cols-[auto_172px]",children:[e.jsxs("div",{className:"mb-3 grid grid-cols-1 sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base leading-tight font-medium text-black",children:s.title}),e.jsxs("span",{className:"flex items-center text-xs leading-none text-gray-400",children:[e.jsx(H,{visibility:s.visibility,sharedFriendIds:s.sharedFriendIds}),e.jsx("span",{className:"mx-2 font-semibold",children:"Â·"}),e.jsx(R,{size:16,className:"mr-1 inline-block h-4 w-4"}),s.topics," topic"]})]}),e.jsxs("div",{className:"mr-1 flex items-center justify-start sm:justify-end",children:[e.jsx(V,{onUpdateSharing:()=>{i(s)},onCustomize:()=>{window.open(a,"_blank")},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&o(s._id).finally(()=>{})}}),e.jsxs("a",{href:a,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-300 bg-white px-2.5 py-1.5 text-xs text-black hover:bg-gray-50 focus:outline-hidden",target:"_blank",children:[e.jsx(F,{className:"inline-block h-4 w-4"}),"Edit"]}),e.jsxs("a",{href:`/r/${s?.slug}`,className:"ml-2 flex items-center gap-2 rounded-md border border-blue-400 bg-white px-2 py-1.5 text-xs text-blue-600 hover:bg-blue-50 focus:outline-hidden",target:"_blank",children:[e.jsx(S,{className:"inline-block h-4 w-4"}),"Visit"]})]})]},s._id)}const q={public:{icon:T,label:"Public"},me:{icon:N,label:"Only me"},team:{icon:v,label:"Team Member(s)"},friends:{icon:v,label:"Friend(s)"}};function H(n){const{visibility:s,sharedFriendIds:o=[]}=n,{label:i,icon:a}=q[s];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 text-xs font-normal whitespace-nowrap",children:[e.jsx(a,{className:"inline-block h-3 w-3"}),e.jsxs("div",{className:"flex items-center",children:[s==="friends"&&o?.length>0&&e.jsx("span",{className:"mr-1",children:o.length}),i]})]})}$({meta:{src:"/_astro/roadmap.5FpLxumP.svg",width:24,height:24,format:"svg"},attributes:{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"1.5","stroke-linecap":"round",strokeLinejoin:"round",class:"lucide lucide-milestone"},children:'<path d="M18 6H5a2 2 0 0 0-2 2v3a2 2 0 0 0 2 2h13l4-3.5L18 6Z"></path><path d="M12 13v8"></path><path d="M12 3v3"></path>'});function X(n){const{roadmaps:s}=n,o=new Set(s.map(a=>a.creator.id)),i=[];for(const a of o){const r=s.find(t=>t.creator.id===a)?.creator;r&&i.push({creator:r,roadmaps:s.filter(t=>t.creator.id===a)})}return s.length===0?e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[e.jsx(A,{className:"mb-4 h-24 w-24 opacity-10"}),e.jsx("h3",{className:"mb-1 text-2xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:"Roadmaps from your friends will appear here"})]}):e.jsxs("div",{children:[e.jsx("div",{className:"mb-3 flex items-center justify-between",children:e.jsxs("span",{className:"text-sm text-gray-400",children:[s.length," shared roadmap(s)"]})}),e.jsx("div",{children:e.jsx("ul",{className:"grid grid-cols-1 gap-4 sm:grid-cols-2",children:i.map(a=>{const r=a.creator;return e.jsxs("li",{className:"flex flex-col items-start overflow-hidden rounded-md border border-gray-300",children:[e.jsxs("div",{className:"relative flex w-full items-center gap-3 p-3",children:[e.jsx("img",{src:r.avatar?`https://dodrc8eu8m09s.cloudfront.net/avatars/${r.avatar}`:"/images/default-avatar.png",alt:r.name||"",className:"h-8 w-8 rounded-full"}),e.jsxs("div",{children:[e.jsx("h3",{className:"truncate font-medium",children:r.name}),e.jsxs("p",{className:"truncate text-sm text-gray-500",children:[a?.roadmaps?.length||0," shared roadmap(s)"]})]})]}),e.jsx("ul",{className:"w-full",children:a?.roadmaps?.map(t=>e.jsx("li",{className:"relative flex w-full border-t",children:e.jsxs("a",{href:`/r/=${t?.slug}`,className:"group inline-grid w-full grid-cols-[auto_16px] items-center justify-between gap-2 px-3 py-2 text-sm text-gray-600 transition-colors hover:bg-gray-100 hover:text-black",target:"_blank",children:[e.jsx("span",{className:"w-full truncate",children:t.title}),e.jsx(S,{size:16,className:"opacity-20 transition-opacity group-hover:opacity-100"})]})},t._id))})]},r.id)})})})]})}const Z=[{label:"Personal",value:"personal"},{label:"Shared by Friends",value:"shared"}],y=3;function ge(){const n=w(),[s,o]=p.useState(!0),[i,a]=p.useState(!1),[r,t]=p.useState(!1),[l,g]=p.useState("personal"),[u,h]=p.useState({personalRoadmaps:[],sharedRoadmaps:[]}),{isPaidUser:b,isLoading:d}=E();async function x(){o(!0);const{response:c,error:f}=await M("https://api.roadmap.sh/v1-get-user-roadmap-list");if(f||!c){console.error(f),n.error(f?.message||"Something went wrong, please try again");return}h(c||{personalRoadmaps:[],sharedRoadmaps:[]})}if(p.useEffect(()=>{x().finally(()=>{o(!1),j.set("")})},[]),s)return null;const m=u.personalRoadmaps.length,k=!b&&m>=y;return e.jsxs("div",{children:[i&&e.jsx(I,{onClose:()=>a(!1)}),r&&e.jsx(O,{onClose:()=>t(!1)}),e.jsxs("div",{className:"mb-6 flex flex-col justify-between gap-2 sm:flex-row sm:items-center sm:gap-0",children:[e.jsx("div",{className:"flex grow items-center gap-2",children:Z.map(c=>e.jsx("button",{className:`relative flex w-full items-center justify-center rounded-md border p-1 px-3 text-sm whitespace-nowrap sm:w-auto ${l===c.value?"border-gray-400 bg-gray-200":""} w-full sm:w-auto`,onClick:()=>g(c.value),children:c.label},c.value))}),e.jsx("button",{className:"relative flex w-full items-center justify-center rounded-md border p-1 px-3 text-sm sm:w-auto",onClick:()=>{if(k){t(!0);return}a(!0)},disabled:d,children:"+ Create Roadmap"})]}),e.jsxs("div",{className:"mt-4",children:[l==="personal"&&e.jsx(B,{maxLimit:b?-1:Math.max(y,m),roadmaps:u?.personalRoadmaps,setAllRoadmaps:h,onUpgrade:()=>t(!0),onDelete:c=>{h({...u,personalRoadmaps:u.personalRoadmaps.filter(f=>f._id!==c)})}}),l==="shared"&&e.jsx(X,{roadmaps:u?.sharedRoadmaps})]})]})}export{y as M,ge as R};
