import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{g as te}from"./browser.3c2kCsRM.js";import{r as n}from"./index.Z3BHPS3u.js";import{a as A,c as U}from"./http.BJhNQusg.js";import{p as m}from"./page.DyYQD7MX.js";import{u as re}from"./index.BlfZEqDn.js";import{b as oe}from"./team.D9_M1CfW.js";import{u as ie}from"./use-toast.BdCcSTJE.js";import{S as ne,C as le}from"./ContentConfirmationModal.DJTP6hFh.js";import{P as de}from"./PickRoadmapOptionModal.DnuRXYVn.js";import{C as me}from"./CreateRoadmapModal.CA3sOjAy.js";import{u as ce}from"./use-outside-click.DYGsxgbd.js";import{M as pe}from"./MoreVerticalIcon.C41XtKgl.js";import{E as ue}from"./ellipsis-vertical.Di0fjBX0.js";import{L as G}from"./lock.C0C-BW9S.js";import{S as B}from"./shapes.Dk0DUUzC.js";import{T as xe}from"./trash-2.CIQaIo_h.js";import{U as he}from"./UpdateTeamResourceModal.CEtlg_jq.js";import{S as fe}from"./ShareOptionsModal.sS-OMsnI.js";import{c as ge}from"./classname.y9b8gBZq.js";import{R as be}from"./RoadmapIcon.x-v-C98i.js";import{S as F}from"./square-pen.CCkK4Twl.js";import{E as V}from"./external-link.J5OYJvOa.js";import{c as H}from"./createLucideIcon.BSLrQS80.js";import{U as q}from"./users.DjpFdpTD.js";import{G as ye}from"./globe.B6R113av.js";import"./js.cookie.Cz0CWeBA.js";import"./fp.esm.CznIeghd.js";import"./jwt.1xGNZsvU.js";import"./index.3whys8t3.js";import"./index.BHh4vvK5.js";import"./toast.DlejBBdi.js";import"./use-keydown.r409VyJJ.js";import"./x.BOdyWiWF.js";import"./Modal.NtjGPDbq.js";import"./map.DuWy2ZcB.js";import"./loader-circle.DfB4mNyf.js";import"./index.gjAxZpWu.js";import"./Spinner.CPY-6wbR.js";import"./resource-progress.Ow4RVjGh.js";import"./roadmap.DwTTnFhR.js";/* empty css                       */import"./dom.B_TnKQIa.js";import"./use-copy-text.D2rWbbuk.js";import"./user-round-plus.DKfQoNU2.js";import"./check.DflWYpXj.js";import"./copy.CgTXj779.js";import"./users-round.D8eM98xM.js";import"./earth.ApD3nwNq.js";import"./circle-check-big.CnV0y9bI.js";import"./twitter.BGXl0Xk3.js";import"./facebook.Diu2wQCs.js";import"./linkedin.DR3T_WSD.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const je=[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]],ve=H("package-minus",je);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],we=H("package",Ne);function T(o){const{onDelete:r,onUpdateSharing:i,onCustomize:c}=o,d=n.useRef(null),[p,l]=n.useState(!1);return ce(d,()=>{l(!1)}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{disabled:!1,onClick:()=>l(!p),className:"hidden items-center opacity-60 transition-opacity hover:opacity-100 disabled:cursor-not-allowed disabled:opacity-30 sm:flex",children:e.jsx(pe,{className:"h-4 w-4"})}),e.jsxs("button",{disabled:!1,onClick:()=>l(!p),className:"flex items-center gap-1 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-hidden sm:hidden",children:[e.jsx(ue,{size:14}),"Options"]}),p&&e.jsx("div",{ref:d,className:"align-right absolute right-auto top-full z-50 mt-1 w-[140px] rounded-md bg-slate-800 px-2 py-2 text-white shadow-md sm:right-0",children:e.jsxs("ul",{children:[i&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{l(!1),i()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(G,{size:14,className:"mr-2"}),"Sharing"]})}),c&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{l(!1),c()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(B,{size:14,className:"mr-2"}),"Customize"]})}),r&&e.jsx("li",{children:e.jsxs("button",{onClick:()=>{l(!1),r()},className:"flex w-full cursor-pointer items-center rounded-sm p-2 text-sm font-medium text-slate-100 hover:bg-slate-700",children:[e.jsx(xe,{size:14,className:"mr-2"}),"Delete"]})})]})})]})}function Is(){const{t:o}=te(),r=re(oe),i=ie(),[c,d]=n.useState(!0),[p,l]=n.useState(!1),[J,b]=n.useState(!1),[K,R]=n.useState(!1),[k,$]=n.useState(""),[y,Q]=n.useState(),[h,f]=n.useState([]),[I,W]=n.useState([]),[u,S]=n.useState(null),[_,M]=n.useState("");async function E(){const{error:s,response:a}=await A("/pages.json");if(s){i.error(s.message||"Something went wrong");return}if(!a)return[];const t=a.filter(x=>x.group==="Roadmaps").sort((x,w)=>x.title==="Android"?1:x.title.localeCompare(w.title));return W(t),a}async function X(s){const{response:a,error:t}=await A(`https://api.hnmdevs.com/v1-get-team/${s}`);if(t||!a){i.error("Error loading team"),window.location.href="/account";return}Q(a)}async function z(s){const{error:a,response:t}=await A(`https://api.hnmdevs.com/v1-get-team-resource-config/${s}`);if(a||!Array.isArray(t)){console.error(a);return}f(t)}n.useEffect(()=>{o&&(d(!0),Promise.all([X(o),z(o),E()]).finally(()=>{m.set(""),d(!1)}))},[o]);async function Y(s){if(!y?._id)return;i.loading("Deleting roadmap"),m.set("Deleting roadmap from team");const{error:a,response:t}=await U(`https://api.hnmdevs.com/v1-delete-team-resource-config/${y._id}`,{resourceId:s,resourceType:"roadmap"});if(a||!t){i.error(a?.message||"Something went wrong");return}i.success("Roadmap removed"),f(t)}async function C(s,a=!1){if(!o)return;i.loading("Adding roadmap"),m.set("Adding roadmap"),d(!0);const t=I.find(ae=>ae.id===s),{error:x,response:w}=await U(`https://api.hnmdevs.com/v1-update-team-resource-config/${o}`,{teamId:o,resourceId:s,resourceType:"roadmap",removed:[],renderer:t?.renderer||"balsamiq",shouldCopyContent:a});if(x||!w){i.error(x?.message||"Error adding roadmap");return}f(w),i.success("Roadmap added"),t?.renderer==="editor"&&b(!1)}async function j(s){m.set("Removing roadmap"),Y(s).finally(()=>{m.set("")})}if(n.useEffect(()=>{function s(a){const{roadmapId:t}=a?.detail;t&&(E().finally(()=>{}),C(t).finally(()=>{m.set("")}))}return window.addEventListener("custom-roadmap-created",s),()=>{window.removeEventListener("custom-roadmap-created",s)}},[]),!y)return null;const P=p&&e.jsx(de,{onClose:()=>l(!1),showDefaultRoadmapsModal:()=>{b(!0),l(!1)},showCreateCustomRoadmapModal:()=>{R(!0),l(!1)}}),Z=I.filter(s=>!h.find(a=>a?.defaultRoadmapId===s.id)),D=J&&e.jsx(ne,{onClose:()=>b(!1),teamResourceConfig:h.map(s=>s.resourceId),allRoadmaps:Z.filter(s=>s.renderer==="editor"),teamId:o,onRoadmapAdd:s=>{if(!I.find(t=>t.id===s&&t.renderer==="editor")){C(s).finally(()=>{m.set("")});return}b(!1),M(s)},onRoadmapRemove:s=>{confirm("Are you sure you want to remove this roadmap?")&&j(s).finally(()=>{})}}),O=_&&e.jsx(le,{onClose:()=>{M("")},onClick:s=>{C(_,s).finally(()=>{m.set(""),M("")})}}),L=K&&e.jsx(me,{teamId:o,onClose:()=>{R(!1)},onCreated:()=>{z(o).finally(()=>null),R(!1)}}),v=h.filter(s=>s.isCustomResource&&!s.topics),N=h.filter(s=>s.isCustomResource&&s.topics),g=h.filter(s=>!s.isCustomResource);if(!(N.length>0||g.length>0||v.length>0&&r)&&!c)return e.jsxs("div",{className:"flex flex-col items-center p-4 py-20",children:[P,D,L,O,e.jsx(be,{className:"mb-3 h-14 w-14 opacity-10"}),e.jsx("h3",{className:"mb-1 text-xl font-bold text-gray-900",children:"No roadmaps"}),e.jsx("p",{className:"text-base text-gray-500",children:r?"Add a roadmap to start tracking your team":"Ask your team admin to add some roadmaps"}),r&&e.jsx("button",{className:"mt-3 rounded-md bg-black px-3 py-1.5 font-medium text-white hover:bg-gray-900 text-sm",onClick:()=>l(!0),children:"Add roadmap"})]});const ee=k&&e.jsx(he,{onClose:()=>$(""),resourceId:k,resourceType:"roadmap",teamId:y?._id,setTeamResourceConfig:f,defaultRemovedItems:g.find(s=>s.resourceId===k)?.removed||[]}),se=u&&e.jsx(fe,{description:u.description,visibility:u.visibility,sharedTeamMemberIds:u.sharedTeamMemberIds,sharedFriendIds:u.sharedFriendIds,teamId:o,roadmapId:u.resourceId,onShareSettingsUpdate:s=>{f(a=>a.map(t=>t.resourceId!==u.resourceId?t:{...t,...s}))},onClose:()=>S(null)});return e.jsxs("div",{children:[P,D,L,ee,se,O,r&&v.length>0&&e.jsxs("div",{className:"mb-5",children:[e.jsx("div",{className:"mb-2 flex items-center justify-between",children:e.jsxs("h3",{className:"flex w-full items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{className:"flex",children:"Placeholder Roadmaps"}),e.jsxs("span",{className:"normal-case",children:["Total ",v.length," roadmap(s)"]})]})}),e.jsx("div",{className:"flex flex-col divide-y rounded-md border",children:v.map(s=>e.jsxs("div",{className:"grid grid-cols-1 p-2.5 sm:grid-cols-[auto_173px]",children:[e.jsxs("div",{className:"mb-3 grid sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsx("span",{className:"text-xs italic leading-none text-gray-400/60",children:"Placeholder roadmap"})]}),r&&e.jsxs("div",{className:"flex items-center justify-start gap-2 sm:justify-end",children:[e.jsx(T,{onUpdateSharing:()=>{S(s)},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&j(s.resourceId).finally(()=>{})}}),e.jsxs("a",{href:`https://draw.hnmdevs.com/${s.resourceId}`,className:"flex gap-2 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-hidden",target:"_blank",children:[e.jsx(F,{className:"inline-block h-4 w-4"}),"Create Roadmap"]})]})]},s.resourceId))})]}),N.length>0&&e.jsxs("div",{className:"mb-5",children:[e.jsx("div",{className:"mb-2 flex items-center justify-between",children:e.jsxs("h3",{className:"flex w-full items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{className:"flex",children:"Custom Roadmaps"}),e.jsxs("span",{className:"normal-case",children:["Total ",N.length," roadmap(s)"]})]})}),e.jsx("div",{className:"flex flex-col divide-y rounded-md border",children:N.map(s=>{const a=`https://draw.hnmdevs.com/${s.resourceId}`;return e.jsxs("div",{className:ge("grid grid-cols-1 p-2.5",r?"sm:grid-cols-[auto_172px]":"sm:grid-cols-[auto_110px]"),children:[e.jsxs("div",{className:"mb-3 grid grid-cols-1 sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsxs("span",{className:"flex items-center text-xs leading-none text-gray-400",children:[e.jsx(ke,{visibility:s.visibility,sharedTeamMemberIds:s.sharedTeamMemberIds,sharedFriendIds:s.sharedFriendIds}),e.jsx("span",{className:"mx-2 font-semibold",children:"·"}),e.jsx(B,{size:16,className:"mr-1 inline-block h-4 w-4"}),s.topics," topic"]})]}),e.jsxs("div",{className:"mr-1 flex items-center justify-start sm:justify-end",children:[r&&e.jsx(T,{onUpdateSharing:()=>{S(s)},onCustomize:()=>{window.open(a,"_blank")},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&j(s.resourceId).finally(()=>{})}}),e.jsxs("a",{href:`/r/${s.roadmapSlug}`,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-hidden",target:"_blank",children:[e.jsx(V,{className:"inline-block h-4 w-4"}),"Visit"]}),r&&e.jsxs("a",{href:a,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-800 bg-gray-900 px-2.5 py-1.5 text-xs text-white hover:bg-gray-800 focus:outline-hidden",target:"_blank",children:[e.jsx(F,{className:"inline-block h-4 w-4"}),"Edit"]})]})]},s.resourceId)})})]}),g.length>0&&e.jsxs("div",{children:[e.jsx("div",{className:"mb-2 flex items-center justify-between",children:e.jsxs("h3",{className:"flex w-full items-center justify-between text-xs uppercase text-gray-400",children:[e.jsx("span",{className:"flex",children:"Default Roadmaps"}),e.jsxs("span",{className:"normal-case",children:["Total ",g.length," roadmap(s)"]})]})}),e.jsx("div",{className:"flex flex-col divide-y rounded-md border",children:g.map(s=>e.jsxs("div",{className:"grid grid-cols-1 p-3 sm:grid-cols-[auto_110px]",children:[e.jsxs("div",{className:"mb-3 grid grid-cols-1 sm:mb-0",children:[e.jsx("p",{className:"mb-1.5 truncate text-base font-medium leading-tight text-black",children:s.title}),e.jsxs("span",{className:"flex items-center text-xs leading-none text-gray-400",children:[s?.removed?.length>0&&e.jsxs(e.Fragment,{children:[e.jsx(ve,{size:16,className:"mr-1 inline-block h-4 w-4"}),s.removed.length," topics removed"]}),!s?.removed?.length&&e.jsxs(e.Fragment,{children:[e.jsx(we,{size:16,className:"mr-1 inline-block h-4 w-4"}),"No changes made"]})]})]}),e.jsxs("div",{className:"mr-1 flex items-center justify-start sm:justify-end",children:[r&&e.jsx(T,{onCustomize:()=>{$(s.resourceId)},onDelete:()=>{confirm("Are you sure you want to remove this roadmap?")&&j(s.resourceId).finally(()=>{})}}),e.jsxs("a",{href:`/${s.resourceId}?t=${o}`,className:"ml-2 flex items-center gap-2 rounded-md border border-gray-300 bg-white px-2 py-1.5 text-xs hover:bg-gray-50 focus:outline-hidden",target:"_blank",children:[e.jsx(V,{className:"inline-block h-4 w-4"}),"Visit"]})]})]},s.resourceId))})]}),r&&e.jsx("div",{className:"mt-5",children:e.jsx("button",{className:"block w-full rounded-md border border-dashed border-gray-300 py-2 text-sm transition-colors hover:border-gray-600 hover:bg-gray-50 focus:outline-0",onClick:()=>l(!0),children:"+ Add new Roadmap"})})]})}const Re={public:{icon:ye,label:"Public"},me:{icon:G,label:"Only me"},team:{icon:q,label:"Team Member(s)"},friends:{icon:q,label:"Friend(s)"}};function ke(o){const{visibility:r,sharedTeamMemberIds:i=[],sharedFriendIds:c=[]}=o,{label:d,icon:p}=Re[r];return e.jsxs("span",{className:"inline-flex items-center gap-1.5 whitespace-nowrap text-xs font-normal",children:[e.jsx(p,{className:"inline-block h-3 w-3"}),e.jsxs("div",{className:"flex items-center",children:[r==="team"&&i?.length>0&&e.jsx("span",{className:"mr-1",children:i.length}),r==="friends"&&c?.length>0&&e.jsx("span",{className:"mr-1",children:c.length}),d]})]})}export{Is as TeamRoadmaps};
