import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as t}from"./index.Z3BHPS3u.js";import{O as T}from"./index.gjAxZpWu.js";import{S as w}from"./Spinner.CPY-6wbR.js";import{c as U}from"./http.BJhNQusg.js";import{r as p}from"./resource-progress.BKggaGKm.js";/* empty css                       */import{u as L}from"./use-outside-click.DYGsxgbd.js";import{u as $}from"./use-keydown.r409VyJJ.js";import{u as z}from"./use-toast.BdCcSTJE.js";import{r as P}from"./dom.B_TnKQIa.js";function Q(j){const{defaultRemovedItems:y=[],resourceId:n,resourceType:d,teamId:m,setTeamResourceConfig:E,onClose:i}=j,u=t.useRef(null),g=t.useRef(null),h=z(),[N,k]=t.useState(!0),[C,x]=t.useState(!1),[o,v]=t.useState(y);t.useEffect(()=>{function s(a){const c=a.target.closest(".clickable-group")?.dataset?.groupId;if(!c)return;const r=c.replace(/^\d+-/,"");o.includes(r)?(v(f=>f.filter(S=>S!==r)),p(r,"reset")):(v(f=>[...f,r]),p(r,"removed"))}return document.addEventListener("click",s),()=>{document.removeEventListener("click",s)}},[o]);let l="https://roadmap.sh";d==="roadmap"?l+=`/${n}.json`:l+=`/best-practices/${n}.json`;async function R(s){const b=await(await fetch(s)).json(),c=await T(b,{fontURL:"/fonts/balsamiq.woff2"});P(u.current,c),o.forEach(r=>{p(r,"removed")})}$("Escape",()=>{i()}),L(g,()=>{i()});async function I(){if(o.length===0)return;x(!0);const{error:s,response:a}=await U(`undefined/v1-update-team-resource-config/${m}`,{teamId:m,resourceId:n,resourceType:d,removed:o});if(s||!a){h.error(s?.message||"Error adding roadmap");return}E(a),i()}return t.useEffect(()=>{!u.current||!l||!n||!d||!m||R(l).catch(s=>{console.error(s),h.error("Something went wrong. Please try again!")}).finally(()=>{k(!1)})},[]),e.jsx("div",{className:"fixed left-0 right-0 top-0 z-100 h-full items-center justify-center overflow-y-auto overflow-x-hidden overscroll-contain bg-black/50",children:e.jsx("div",{className:"relative mx-auto h-full w-full max-w-4xl p-4 md:h-auto",children:e.jsxs("div",{id:"customized-roadmap",ref:g,className:"popup-body relative rounded-lg bg-white shadow-sm",children:[e.jsxs("div",{className:"sticky top-0 mb-3 rounded-2xl border-4 border-white bg-black p-4",children:[e.jsx("p",{className:"mb-2 text-gray-300",children:"Click and select the items to remove from the roadmap."}),e.jsxs("div",{className:"flex flex-row items-center gap-1.5",children:[e.jsx("button",{disabled:o.length===0,onClick:()=>I().finally(()=>x(!1)),className:"rounded-md bg-blue-600 px-2.5 py-1.5 text-sm text-white hover:bg-blue-700 disabled:cursor-not-allowed disabled:bg-blue-400",children:C?e.jsxs("span",{className:"flex items-center gap-1.5",children:[e.jsx(w,{className:"h-3 w-3",innerFill:"white",isDualRing:!1})," ","Saving .."]}):"Save Changes"}),e.jsx("button",{onClick:i,className:"rounded-md bg-gray-600 px-2.5 py-1.5 text-sm text-white hover:bg-gray-700",children:"Cancel"})]})]}),e.jsx("div",{id:"resource-svg-wrap",ref:u,className:"px-4"}),N&&e.jsx("div",{className:"flex w-full justify-center",children:e.jsx(w,{isDualRing:!1,className:"mb-4 mt-2 h-4 w-4 animate-spin fill-blue-600 text-gray-200 sm:h-8 sm:w-8"})})]})})})}export{Q as U};
