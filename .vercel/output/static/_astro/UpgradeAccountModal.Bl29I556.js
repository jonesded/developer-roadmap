import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{u as R,q as j}from"./query-client.zrB8z_yM.js";import{u as $}from"./useMutation.BxVH4XRI.js";import{r as i}from"./index.Z3BHPS3u.js";import{u as A}from"./use-toast.BdCcSTJE.js";import{g as B}from"./jwt.1xGNZsvU.js";import{a as z}from"./query-http.Bohx3EqF.js";import{b as D,U as c}from"./billing.Dog7Gwv_.js";import{M as u}from"./Modal.NtjGPDbq.js";import{U as T}from"./UpdatePlanConfirmation.NT5hFl0c.js";import{L as x}from"./loader-circle.DfB4mNyf.js";import{X as N}from"./x.BOdyWiWF.js";import{c as v}from"./createLucideIcon.BSLrQS80.js";import{Z as q}from"./zap.BNbCfd_G.js";import{M as F}from"./message-circle.C1uJbl19.js";import{M as H}from"./map.DuWy2ZcB.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],Z=v("archive",O);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]],K=v("crown",G),Q=[{icon:q,title:"Unlimited Courses and Guides",description:"No limits on number of courses, guides, and quizzes",highlight:!0},{icon:F,title:"Extended Chat Limits",description:"Chat with AI Tutor and Roadmaps without limits"},{icon:Z,title:"Chat History",description:"Access your AI Tutor and roadmap chats later"},{icon:H,title:"Custom Roadmaps",description:"Create upto 100 custom roadmaps"}];function me(C){const{onClose:r,success:P,cancel:k}=C,[d,h]=i.useState("year"),[U,m]=i.useState(!1),M=B(),{data:p,isLoading:_,error:f}=R(D(),j),E=A(),{mutate:I,isPending:n}=$({mutationFn:t=>z("/v1-create-subscription-checkout-session",t),onSuccess:t=>{window.location.href=t.checkoutUrl},onError:t=>{console.error(t),E.error(t?.message||"Failed to create checkout session")}},j),S=["canceled","incomplete_expired"].includes(p?.status||""),y=c.find(t=>t.interval===d),g=S?null:p?.priceId,s=c.find(t=>t.priceId===g),a=c.find(t=>t.interval==="month"),o=c.find(t=>t.interval==="year");if(i.useEffect(()=>{s&&h(s.interval)},[s]),i.useEffect(()=>{window?.fireEvent({action:"tutor_pricing",category:"ai_tutor",label:"Clicked Upgrade to Pro"})},[]),!M)return null;if(_)return e.jsx(u,{onClose:r,bodyClassName:"p-0 bg-white",wrapperClassName:"h-auto rounded-lg max-w-md w-full mx-4",overlayClassName:"items-center",hasCloseButton:!1,children:e.jsx("div",{className:"flex h-48 items-center justify-center",children:e.jsx(x,{className:"h-6 w-6 animate-spin text-yellow-600"})})});if(f)return e.jsx(u,{onClose:r,bodyClassName:"p-6 bg-white",wrapperClassName:"h-auto rounded-lg max-w-md w-full mx-4",overlayClassName:"items-center",hasCloseButton:!0,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"mx-auto mb-4 flex h-10 w-10 items-center justify-center rounded-full bg-red-100",children:e.jsx(N,{className:"h-5 w-5 text-red-600"})}),e.jsx("h3",{className:"mb-2 text-lg font-medium text-gray-900",children:"Error"}),e.jsx("p",{className:"text-sm text-gray-600",children:f?.message||"An error occurred while loading billing details."})]})});if(U&&y)return e.jsx(T,{planDetails:y,onClose:()=>m(!1),onCancel:()=>m(!1)});const w=t=>{if(t){if(h(t.interval),!g){const l=window.location.pathname,L=`/thank-you?next=${encodeURIComponent(l)}&s=1`;window?.fireEvent({action:"tutor_checkout",category:"ai_tutor",label:"Checkout Started"}),I({priceId:t.priceId,success:P||L,cancel:k||`${l}?s=0`},{onSuccess:()=>{window?.fireEvent({action:`tutor_checkout_${t.interval==="month"?"mo":"an"}`,category:"ai_tutor",label:`${t.interval} Plan Checkout Started`})}});return}m(!0)}};return e.jsx(u,{onClose:r,bodyClassName:"p-0 bg-white",wrapperClassName:"h-auto rounded-lg max-w-md w-full mx-4",overlayClassName:"items-center",hasCloseButton:!1,children:e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:r,className:"absolute top-3 right-3 z-10 flex h-6 w-6 items-center justify-center rounded-full text-gray-400 hover:text-gray-600",children:e.jsx(N,{className:"h-4 w-4"})}),e.jsxs("div",{className:"border-b border-gray-100 px-6 py-6 text-center",children:[e.jsx("div",{className:"mx-auto mb-3 flex h-12 w-12 items-center justify-center rounded-full border-2 border-yellow-200 bg-yellow-50",children:e.jsx(K,{className:"h-6 w-6 text-yellow-600"})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Upgrade to Premium"}),e.jsx("p",{className:"mt-1 text-sm text-gray-600",children:"Unlock all features and supercharge your learning"})]}),e.jsx("div",{className:"px-6 py-4",children:e.jsx("div",{className:"space-y-3",children:Q.map((t,l)=>{const b=t.icon;return e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(b,{className:"relative top-[0.5px] mt-1 size-4 text-gray-600"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"mb-0.5 text-sm font-medium text-gray-900",children:t.title}),e.jsx("p",{className:"text-xs text-gray-600",children:t.description})]})]},l)})})}),e.jsxs("div",{className:"border-t border-gray-100 px-6 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[o&&e.jsx("button",{onClick:()=>w(o),disabled:n||s?.interval==="year",className:`flex h-11 w-full items-center justify-center rounded-lg px-4 text-sm font-medium transition-colors disabled:opacity-50 ${s?.interval==="year"?"cursor-not-allowed bg-yellow-300 text-gray-700":"bg-yellow-400 text-black hover:bg-yellow-500"}`,children:n&&d==="year"?e.jsx(x,{className:"mx-auto h-4 w-4 animate-spin"}):e.jsxs("div",{className:"flex w-full items-center justify-between text-left",children:[e.jsxs("span",{children:["Yearly Plan - $",o.amount,"/year"]}),s?.interval==="year"?e.jsx("span",{className:"rounded bg-green-600 px-2 py-1 text-xs text-white",children:"Current Plan"}):a&&e.jsxs("span",{className:"rounded bg-yellow-600 px-2 py-1 text-xs text-white",children:[Math.round((a.amount*12-o.amount)/a.amount)," ","months free"]})]})}),a&&e.jsx("button",{onClick:()=>w(a),disabled:n||s?.interval==="month",className:`flex h-11 w-full items-center justify-center rounded-lg border px-4 text-sm font-medium transition-colors disabled:opacity-50 ${s?.interval==="month"?"cursor-not-allowed border-yellow-300 bg-yellow-50 text-gray-700":"border-yellow-400 bg-yellow-50 text-black hover:bg-yellow-100"}`,children:n&&d==="month"?e.jsx(x,{className:"mx-auto h-4 w-4 animate-spin"}):e.jsxs("div",{className:"flex w-full items-center justify-between text-left",children:[e.jsxs("span",{children:["Monthly Plan - $",a.amount,"/month"]}),s?.interval==="month"&&e.jsx("span",{className:"rounded bg-black px-2 py-1 text-xs text-white",children:"Current Plan"})]})})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsxs("p",{className:"text-xs text-gray-500",children:["By upgrading you agree to our"," ",e.jsx("a",{href:"/terms",className:"text-yellow-600 hover:underline",children:"terms and conditions"})]})})]})]})})}export{me as U};
