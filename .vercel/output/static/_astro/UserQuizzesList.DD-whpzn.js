import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{q as x,u as b}from"./query-client.zrB8z_yM.js";import{r as i}from"./index.Z3BHPS3u.js";import{g as v,s as w,d as j}from"./browser.3c2kCsRM.js";import{A as N,a as q}from"./AITutorTallMessage.BWFj9o8p.js";import{U as P}from"./UpgradeAccountModal.Bl29I556.js";import{P as C}from"./Pagination.DomnIFR-.js";import{i as A}from"./jwt.1xGNZsvU.js";import{s as L}from"./popup.CdCAhVM2.js";import{l as k}from"./ai-quiz.CvRgTtfI.js";import{c as S}from"./classname.y9b8gBZq.js";import{g as U}from"./date.2wIYh-wy.js";import{u as Q}from"./use-outside-click.DYGsxgbd.js";import{u as I}from"./use-keydown.r409VyJJ.js";import{u as E}from"./use-toast.BdCcSTJE.js";import{u as T}from"./useMutation.BxVH4XRI.js";import{b as F}from"./query-http.Bohx3EqF.js";import{E as O}from"./ellipsis-vertical.Di0fjBX0.js";import{P as D}from"./play.-yCdF7S0.js";import{T as M}from"./trash-2.CIQaIo_h.js";import{C as R}from"./calendar.DJD-aIIP.js";import{c as B}from"./createLucideIcon.BSLrQS80.js";import{a as _}from"./ai-course.m2sFB2uK.js";import{u as $}from"./billing.Dog7Gwv_.js";import{A as K}from"./AIUsageWarning.DeVtS8bX.js";import{L as V}from"./loader-circle.DfB4mNyf.js";import{B as Y}from"./book-open.Dsgc4gH7.js";import"./use-debounce.CXZLeMbB.js";import"./search.CUAljTEc.js";import"./Modal.NtjGPDbq.js";import"./x.BOdyWiWF.js";import"./UpdatePlanConfirmation.NT5hFl0c.js";import"./VerifyUpgrade.B0n18ihL.js";import"./circle-check-big.CnV0y9bI.js";import"./zap.BNbCfd_G.js";import"./message-circle.C1uJbl19.js";import"./map.DuWy2ZcB.js";import"./number.DnDLgi2j.js";import"./ellipsis.BcvtAoad.js";import"./js.cookie.Cz0CWeBA.js";import"./index.browser.OxPLOBIU.js";import"./chat.C-0TRz4N.js";import"./toast.DlejBBdi.js";import"./index.3whys8t3.js";import"./fp.esm.CznIeghd.js";/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]],W=B("clipboard-check",H);function G(c){const{quizSlug:r,onDeleted:l}=c,o=E(),s=i.useRef(null),[n,u]=i.useState(!1),[f,d]=i.useState(!1),{mutate:h,isPending:m}=T({mutationFn:async()=>F(`/v1-delete-ai-quiz/${r}`),onSuccess:()=>{o.success("Quiz deleted"),x.invalidateQueries({predicate:t=>t.queryKey?.[0]==="user-ai-quizzes"}),l?.()},onError:t=>{o.error(t?.message||"Failed to delete quiz")}},x);return Q(s,()=>{u(!1)}),I("Escape",()=>{u(!1)}),e.jsxs("div",{className:"relative h-full",ref:s,children:[e.jsx("button",{className:"h-full text-gray-400 hover:text-gray-700",onClick:t=>{t.stopPropagation(),u(!n)},children:e.jsx(O,{size:16})}),n&&e.jsxs("div",{className:"absolute top-8 right-0 z-10 w-48 overflow-hidden rounded-md border border-gray-200 bg-white shadow-lg",children:[e.jsxs("a",{href:`/ai/quiz/${r}`,className:"flex w-full items-center gap-1.5 p-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-black disabled:cursor-not-allowed disabled:opacity-70",children:[e.jsx(D,{className:"h-3.5 w-3.5"}),"Take Quiz"]}),!f&&e.jsx("button",{className:"flex w-full items-center gap-1.5 p-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-black disabled:cursor-not-allowed disabled:opacity-70",onClick:()=>d(!0),disabled:m,children:m?"Deleting...":e.jsxs(e.Fragment,{children:[e.jsx(M,{className:"h-3.5 w-3.5"}),"Delete Quiz"]})}),f&&e.jsxs("span",{className:"flex w-full items-center justify-between gap-1.5 p-2 text-sm font-medium text-gray-500 hover:bg-gray-100 hover:text-black disabled:cursor-not-allowed disabled:opacity-70",children:["Are you sure?",e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>{d(!1),h()},disabled:m,className:"text-red-500 underline hover:text-red-800",children:"Yes"}),e.jsx("button",{onClick:()=>d(!1),className:"text-red-500 underline hover:text-red-800",children:"No"})]})]})]})]})}function J(c){const{quiz:r,variant:l="row",showActions:o=!0}=c,s=U(r?.updatedAt);return e.jsxs("div",{className:"relative flex flex-grow",children:[e.jsxs("a",{href:`/ai/quiz/${r.slug}`,className:S("group relative flex h-full w-full gap-3 overflow-hidden rounded-lg border border-gray-200 bg-white p-4 text-left transition-all hover:border-gray-300 hover:bg-gray-50 sm:gap-4",l==="column"&&"flex-col",l==="row"&&"sm:flex-col sm:items-start"),children:[e.jsx("div",{className:"min-w-0 flex-1",children:e.jsx("h3",{className:"line-clamp-2 text-base font-semibold text-balance text-gray-900",children:r.title})}),e.jsx("div",{className:"mt-4 flex items-center gap-4 sm:gap-4",children:e.jsxs("div",{className:"flex items-center text-xs text-gray-600",children:[e.jsx(R,{className:"mr-1 h-3.5 w-3.5"}),e.jsx("span",{children:s}),e.jsxs("div",{className:"ml-3 flex items-center text-xs text-gray-600",children:[e.jsx(W,{className:"mr-1 h-3.5 w-3.5"}),e.jsx("span",{className:"capitalize",children:r.format==="mcq"?"MCQ":r.format})]})]})})]}),o&&r.slug&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx(G,{quizSlug:r.slug})})]})}function _e(){const[c,r]=i.useState(!0),[l,o]=i.useState(!1),[s,n]=i.useState({perPage:"21",currPage:"1",query:""}),{isPaidUser:u,isLoading:f}=$(),{data:d,isLoading:h}=b(_(),x),m=d?.quiz,{data:t,isFetching:z}=b(k(s),x);i.useEffect(()=>{r(!1)},[t]);const y=t?.data??[];i.useEffect(()=>{const a=v();n({...s,currPage:a?.p||"1",query:a?.q||""})},[]),i.useEffect(()=>{s?.currPage!=="1"||s?.query!==""?w({p:s?.currPage||"1",q:s?.query||""}):(j("p"),j("q"))},[s]);const g=A(),p=z||c||f||h;return e.jsxs(e.Fragment,{children:[l&&e.jsx(P,{onClose:()=>o(!1)}),e.jsx(N,{value:s?.query||"",onChange:a=>{n({...s,query:a,currPage:"1"})},placeholder:"Search Quizzes...",disabled:p}),p&&e.jsxs("p",{className:"mb-4 flex flex-row items-center gap-2 text-sm text-gray-500",children:[e.jsx(V,{className:"h-4 w-4 animate-spin"}),"Loading your quizzes..."]}),!p&&e.jsxs(e.Fragment,{children:[e.jsx(K,{type:"quiz",totalCount:t?.totalCount,isPaidUser:u,usedCount:m?.used,limitCount:m?.limit,onUpgrade:()=>o(!0)}),g&&!p&&y.length>0&&e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsx("div",{className:"grid grid-cols-1 gap-2 md:grid-cols-2 xl:grid-cols-3",children:y.map(a=>e.jsx(J,{variant:"column",quiz:a},a._id))}),e.jsx(C,{totalCount:t?.totalCount||0,totalPages:t?.totalPages||0,currPage:Number(t?.currPage||1),perPage:Number(t?.perPage||10),onPageChange:a=>{n({...s,currPage:String(a)})},className:"rounded-lg border border-gray-200 bg-white p-4"})]}),!p&&y.length===0&&e.jsx(q,{title:g?"No quizzes found":"Sign up or login",subtitle:g?"You haven't generated any quizzes yet.":"Takes 2s to sign up and generate your first quiz.",icon:Y,buttonText:g?"Create your first quiz":"Sign up or login",onButtonClick:()=>{g?window.location.href="/ai/quiz":L()}})]})]})}export{_e as UserQuizzesList};
