import{a as f}from"./js.cookie.Cz0CWeBA.js";import{i as d}from"./fp.esm.CznIeghd.js";import{T as m,r as p}from"./jwt.1xGNZsvU.js";class o extends Error{status;message;constructor(t,r){super(r),this.status=t,this.message=r}static isFetchError(t){return t instanceof o}}async function i(e,t){const r=e.startsWith("http")?e:`undefined${e}`;try{const c=await(await d.load()).get(),u=t?.body instanceof FormData,h=new Headers({Accept:"application/json",Authorization:`Bearer ${f.get(m)}`,fp:c.visitorId,...t?.headers??{}});u||h.set("Content-Type","application/json");const n=await fetch(r,{credentials:"include",...t,headers:h}),s=t?.headers?.Accept==="text/html"?await n.text():await n.json();if(s?.status===401)return p(),window.location.href="/login",null;if(!n.ok)throw s.errors?new o(n?.status,s.message):s.message?new o(n?.status,s.message):new Error("An unexpected error occurred");return s}catch(a){throw a}}async function E(e,t,r){return i(e,{...r,method:"POST",body:t instanceof FormData?t:JSON.stringify(t)})}async function A(e,t,r){const a=new URLSearchParams(t).toString(),c=a?`${e}?${a}`:e;return i(c,{credentials:"include",method:"GET",...r})}async function P(e,t,r){return i(e,{...r,method:"PATCH",body:JSON.stringify(t)})}async function T(e,t){return i(e,{...t,method:"DELETE"})}export{o as F,E as a,T as b,P as c,A as h};
