import{a as x}from"./js.cookie.Cz0CWeBA.js";import{h as A,a as C}from"./http.BJhNQusg.js";import{T as R,g as h}from"./jwt.1xGNZsvU.js";import{t as P,r as M}from"./roadmap.DwTTnFhR.js";async function O(e){const{topicId:t,resourceType:o,resourceId:s}=e,{done:r=[]}=await f(o,s)||{};return r?.includes(t)}async function B(e){const{topicId:t,resourceType:o,resourceId:s}=e,r=await f(o,s);return r?.done?.includes(t)?"done":r?.learning?.includes(t)?"learning":r?.skipped?.includes(t)?"skipped":"pending"}async function H(e,t){const{topicId:o,resourceType:s,resourceId:r}=e,{response:n,error:c}=await A("https://api.imoogleai.xyz/v1-update-resource-progress",{topicId:o,resourceType:s,resourceId:r,progress:t});if(c||!n?.done||!n?.learning)throw new Error(c?.message||"Something went wrong");return k(s,r,n.done,n.learning,n.skipped),n}function j(e,t){if(!["frontend","backend","devops","data-analyst","android","full-stack","ai-data-scientist","postgresql-dba","blockchain","qa","software-architect","cyber-security","ux-design","game-developer","server-side-game-developer","technical-writer","mlops","computer-science","react","vue","javascript","angular","nodejs","typescript","python","sql","system-design","aspnet-core","java","cpp","docker","prompt-engineering","aws","datastructures-and-algorithms","kubernetes","linux","software-design-architecture","rust","react-native","graphql","spring-boot","mongodb","flutter","design-system","golang"].includes(t))return;const s=h()?.id;if(!s)return;const r=`${e}-${t}-${s}-progress`,n=`${e}-${t}-${s}-cleared`,c=parseInt(localStorage.getItem(n)||"0",10);c>=10||(localStorage.removeItem(r),localStorage.setItem(n,`${c+1}`))}async function f(e,t){if(!x.get(R))return{done:[],learning:[],skipped:[]};const o=h()?.id,s=`${e}-${t}-${o}-progress`,r=`${e}-${t}-favorite`,n=localStorage.getItem(r),c=JSON.parse(n||"0")===1,a=localStorage.getItem(s),d=JSON.parse(a||"null"),g=d?.timestamp,l=new Date().getTime()-parseInt(g||"0",10)>15*60*1e3;return!d||l?T(e,t):(k(e,t,d?.done||[],d?.learning||[],d?.skipped||[]),window.dispatchEvent(new CustomEvent("mark-favorite",{detail:{resourceType:e,resourceId:t,isFavorite:c}})),d)}async function T(e,t){const{response:o,error:s}=await C("https://api.imoogleai.xyz/v1-get-user-resource-progress",{resourceType:e,resourceId:t});return s||!o?(console.error(s),{done:[],learning:[],skipped:[]}):(k(e,t,o?.done||[],o?.learning||[],o?.skipped||[]),window.dispatchEvent(new CustomEvent("mark-favorite",{detail:{resourceType:e,resourceId:t,isFavorite:o.isFavorite}})),o)}function k(e,t,o,s,r){M.set({done:o,learning:s,skipped:r});const n=h()?.id;localStorage.setItem(`${e}-${t}-${n}-progress`,JSON.stringify({done:o,learning:s,skipped:r,timestamp:new Date().getTime()}))}function N(e,t=document){const o=[];return t.querySelectorAll(`[data-group-id$="-${e}"]`).forEach(s=>{const r=s?.dataset?.groupId||"";new RegExp(`^\\d+-${e}$`).test(r)&&o.push(s)}),p([`[data-group-id="${e}"]`,`[data-group-id="check:${e}"]`,`[data-node-id="${e}"]`,`[data-id="${e}"]`,`[data-checklist-checkbox][data-checklist-id="${e}"]`,`[data-checklist-label][data-checklist-id="${e}"]`],t).forEach(s=>{o.push(s)}),o}function m(e,t){const o=t==="learning",s=t==="skipped",r=t==="done",n=t==="removed";N(e).forEach(a=>{r?(a.classList.add("done"),a.classList.remove("learning","skipped")):o?(a.classList.add("learning"),a.classList.remove("done","skipped")):s?(a.classList.add("skipped"),a.classList.remove("done","learning")):n?(a.classList.add("removed"),a.classList.remove("done","learning","skipped")):a.classList.remove("done","skipped","learning","removed")})}async function G(e,t){const{done:o=[],learning:s=[],skipped:r=[]}=await f(e,t)||{};o.forEach(n=>{m(n,"done")}),s.forEach(n=>{m(n,"learning")}),r.forEach(n=>{m(n,"skipped")}),_()}function p(e,t=document){const o=[];return e.forEach(s=>{t.querySelectorAll(s).forEach(r=>{o.push(r)})}),o}function _(){const e=document.querySelectorAll("[data-progress-nums-container]"),t=document.querySelectorAll("[data-progress-nums]");if(e.length===0||t.length===0)return;const o=p([".clickable-group",'[data-type="todo"]','[data-type="topic"]','[data-type="checklist-item"]','[data-type="subtopic"]',".react-flow__node-topic",".react-flow__node-subtopic"]).length,s=document.querySelectorAll('[data-group-id^="ext_link:"]').length,r=document.querySelectorAll('[data-group-id^="json:"]').length,n=document.querySelectorAll('[data-group-id^="check:"]').length,c=document.querySelectorAll('[data-group-id^="check:"].done').length,a=document.querySelectorAll('[data-type="todo-checkbox"].done').length,d=document.querySelectorAll('[data-group-id^="check:"].learning').length,g=document.querySelectorAll('[data-group-id^="check:"].skipped').length,y=document.querySelectorAll(".clickable-group.removed").length,l=o-s-r-n-y;P.set(l);const v=p(['.clickable-group.done:not([data-group-id^="ext_link:"])',"[data-node-id].done","[data-id].done"]).length-c-a,L=p([".clickable-group.learning","[data-node-id].learning","[data-id].learning"]).length-d,u=p([".clickable-group.skipped","[data-node-id].skipped","[data-id].skipped"]).length-g,E=document.querySelectorAll("[data-progress-done]");E.length>0&&E.forEach(i=>{i.innerHTML=`${v+u}`});const S=document.querySelectorAll("[data-progress-learning]");S.length>0&&S.forEach(i=>i.innerHTML=`${L}`);const $=document.querySelectorAll("[data-progress-skipped]");$.length>0&&$.forEach(i=>i.innerHTML=`${u}`);const w=document.querySelectorAll("[data-progress-total]");w.length>0&&w.forEach(i=>i.innerHTML=`${l}`);const b=Math.round((v+u)/l*100)||0,q=document.querySelectorAll("[data-progress-percentage]");q.length>0&&q.forEach(i=>i.innerHTML=`${b}`),e.forEach(i=>i.classList.remove("striped-loader")),t.forEach(i=>{i.classList.remove("opacity-0")})}export{G as a,_ as b,j as c,B as g,O as i,m as r,N as t,H as u};
